<!doctype html>
<html lang="ja">
 <head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>å°å­¦æ ¡ã‹ã‚“ã˜ãƒã‚¹ã‚¿ãƒ¼ çµ±åˆç‰ˆ</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
        /* --- å…±é€šå¤‰æ•°ãƒ»åŸºæœ¬è¨­å®š --- */
        :root {
            --bg-color: #F4F7F6;
            --g1-color: #FF8A65; --g2-color: #FFD54F; --g3-color: #4FC3F7;
            --g4-color: #81C784; --g5-color: #BA68C8; --g6-color: #7986CB;
        }

        body {
            font-family: 'Mochiy Pop One', sans-serif;
            background-color: var(--bg-color);
            margin: 0; padding: 0; color: #37474F;
            min-height: 100vh; overflow-y: auto; overflow-x: hidden;
            user-select: none; -webkit-user-select: none;
            touch-action: manipulation;
        }

        /* ç”»é¢åˆ‡ã‚Šæ›¿ãˆåˆ¶å¾¡ */
        .view-section { display: none; width: 100%; min-height: 100vh; flex-direction: column; }
        .view-section.active { display: flex; animation: fadeIn 0.3s ease; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- ãƒãƒ¼ã‚¿ãƒ«ç”¨ã‚¹ã‚¿ã‚¤ãƒ« (XPãƒãƒ¼ãªã©) --- */
        #xp-bar-container {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            padding: 10px 15px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); z-index: 200; 
            height: 100px; flex-shrink: 0; border-bottom: 3px solid #4FC3F7;
            position: sticky; top: 0; width: 100%;
        }
        .xp-info { display: flex; align-items: center; gap: 20px; flex-grow: 1; }
        .char-icon { 
            font-size: 3.5rem;
            animation: big-bounce 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            cursor: pointer; padding: 5px 10px; 
            background: linear-gradient(135deg, rgba(255,255,255,0.8), rgba(200,230,255,0.4)); 
            border-radius: 20px; margin-left: 5px;
        }
        .xp-stats { display: flex; flex-direction: column; gap: 4px; flex-grow: 1; }
        .xp-header { display: flex; align-items: baseline; gap: 10px; }
        .xp-text { font-size: 1.1rem; color: #222; font-weight: 700; }
        .xp-desc { font-size: 0.75rem; color: #4FC3F7; background: #E1F5FE; padding: 3px 10px; border-radius: 12px; }
        .progress-track {
            height: 18px; background: #ddd; border-radius: 9px;
            margin: 5px 15px 0 0; overflow: hidden; width: 95%;
        }
        .progress-fill {
            height: 100%; background: linear-gradient(90deg, #4FC3F7, #29B6F6);
            width: 0%; transition: width 1s; border-radius: 8px;
        }
        @keyframes big-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        /* --- ãƒãƒ¼ã‚¿ãƒ«ãƒ¡ã‚¤ãƒ³ç”»é¢ --- */
        header.portal-header {
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;
        }
        .logo { font-size: 1.3rem; font-weight: 700; color: #2c3e50; }
        .hero-text { text-align: center; margin: 20px 0; }
        .grade-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px; padding: 20px; max-width: 900px; margin: 0 auto;
        }
        .grade-card {
            background: white; border-radius: 22px; padding: 20px;
            text-align: center; cursor: pointer; position: relative; overflow: hidden;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1); transition: transform 0.2s;
            height: 160px; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .grade-card:hover { transform: translateY(-5px); }
        .card-icon { font-size: 3.5rem; margin-bottom: 10px; z-index: 2; }
        .card-title { font-size: 1.2rem; font-weight: 800; color: #333; z-index: 2; }
        .decoration-circle {
            position: absolute; width: 120px; height: 120px; border-radius: 50%;
            opacity: 0.15; z-index: 1; top: -40px; right: -40px;
        }

        /* --- ã‚¢ãƒ—ãƒªï¼ˆå­¦ç¿’ï¼‰ç”»é¢ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .app-container {
            display: flex; flex-direction: column; align-items: center; 
            padding: 20px; width: 100%; max-width: 800px; margin: 0 auto;
        }
        
        /* ãƒ¢ãƒ¼ãƒ‰é¸æŠï¼ˆã‚¢ãƒ—ãƒªå†…ãƒˆãƒƒãƒ—ï¼‰ */
        .mode-select-title {
            font-size: 2rem; margin: 30px 0; text-align: center; 
            color: #333; text-shadow: 2px 2px 0 #fff;
        }
        .mode-btn {
            width: 100%; max-width: 300px; font-size: 1.4rem; padding: 15px;
            border-radius: 50px; border: none; cursor: pointer; margin: 10px 0;
            color: white; display: flex; align-items: center; justify-content: center; gap: 10px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.15); transition: transform 0.1s;
        }
        .mode-btn:active { transform: translateY(4px); box-shadow: none; }
        .btn-practice { background: linear-gradient(135deg, #66BB6A, #4CAF50); }
        .btn-test { background: linear-gradient(135deg, #EF5350, #F44336); }
        .btn-back { background: #90A4AE; font-size: 1rem; padding: 10px 20px; margin-top: 20px; }

        /* æ¼¢å­—ãƒªã‚¹ãƒˆç”»é¢ */
        .list-header {
            width: 100%; display: flex; justify-content: space-between; align-items: center;
            background: white; padding: 15px; border-radius: 15px; margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .kanji-grid-list {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px; width: 100%; padding-bottom: 50px;
        }
        .kanji-item {
            aspect-ratio: 1; background: white; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; cursor: pointer; border: 2px solid #eee;
            position: relative; transition: transform 0.1s;
        }
        .kanji-item:active { transform: scale(0.95); }
        .kanji-item.cleared-practice { background: #F1F8E9; border-color: #8BC34A; }
        .kanji-item.cleared-test { background: #FFEBEE; border-color: #EF5350; }
        .mark-badge { position: absolute; top: -5px; right: -5px; font-size: 1rem; }

        /* ç·´ç¿’ï¼ˆCanvasï¼‰ç”»é¢ */
        .canvas-area {
            background: white; padding: 10px; border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin: 20px 0;
            position: relative;
        }
        #character-target { width: 300px; height: 300px; touch-action: none; }
        .target-reading { font-size: 1.5rem; color: #0277BD; margin-bottom: 10px; font-weight: bold; }
        .message-box { height: 30px; font-weight: bold; color: #555; text-align: center; }

        /* çµæœãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
        #result-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); display: none; z-index: 1000;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .result-emoji { font-size: 5rem; animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .result-text { font-size: 2rem; margin: 20px 0; font-weight: bold; }
        
        /* æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ */
        #search-input-portal {
            width: 100%; padding: 12px; border-radius: 30px; border: 2px solid #ddd;
            font-size: 1rem; outline: none; transition: border-color 0.3s;
        }
        #search-input-portal:focus { border-color: #4FC3F7; }

        /* ãã®ä»–è¨­å®š */
        .footer-note { font-size: 0.8rem; color: #666; padding: 20px; text-align: center; background: #fff; margin-top: 30px;}
        .hidden { display: none !important; }
        
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1); } }
        @media (max-width: 480px) {
            #character-target { width: 260px; height: 260px; }
            .grade-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
 </head>
 <body>

  <div id="xp-bar-container">
   <div class="xp-info">
    <div class="char-icon" id="current-char" onclick="alert('ãŸãã•ã‚“ã¹ã‚“ãã‚‡ã†ã—ã¦ é€²åŒ–ã•ã›ã‚ˆã†ï¼')">ğŸ¥š</div>
    <div class="xp-stats">
     <div class="xp-header">
      <div class="xp-text">Lv.<span id="current-lvl">0</span></div>
      <div class="xp-desc">å‹‰å¼·ã—ã¦é€²åŒ–ï¼</div>
     </div>
     <div class="progress-track">
      <div class="progress-fill" id="xp-fill"></div>
     </div>
    </div>
   </div>
   <button onclick="resetAllData()" style="font-size:0.8rem; background:#ECEFF1; border:none; padding:5px 10px; border-radius:10px; color:#999;">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>

  <div id="portal-screen" class="view-section active">
    <header class="portal-header">
        <div class="logo">ğŸ« æ¼¢å­—ãƒã‚¹ã‚¿ãƒ¼</div>
        <div style="width: 200px;">
            <input type="text" id="search-input-portal" placeholder="ã‹ã‚“ã˜ãƒ»ã‚ˆã¿æ¤œç´¢" oninput="handleGlobalSearch(this.value)">
        </div>
    </header>

    <div class="hero-text">
        <h2 style="font-size:1.5rem; margin-bottom:5px;">ã©ã®å­¦å¹´ã‚’ã¯ã˜ã‚ã‚‹ï¼Ÿ</h2>
        <p style="color:#78909C; font-size:0.9rem;">å…¨1026æ–‡å­— å®Œå…¨å¯¾å¿œï¼</p>
    </div>

    <div id="global-search-results" class="grade-grid hidden"></div>

    <div id="grade-selection-grid" class="grade-grid">
        <div class="grade-card" onclick="launchGrade(1)" style="border-bottom: 5px solid var(--g1-color);">
            <div class="decoration-circle" style="background: var(--g1-color);"></div>
            <div class="card-icon">ğŸ£</div>
            <div class="card-title">1ã­ã‚“ã›ã„</div>
        </div>
        <div class="grade-card" onclick="launchGrade(2)" style="border-bottom: 5px solid var(--g2-color);">
            <div class="decoration-circle" style="background: var(--g2-color);"></div>
            <div class="card-icon">ğŸ¹</div>
            <div class="card-title">2ã­ã‚“ã›ã„</div>
        </div>
        <div class="grade-card" onclick="launchGrade(3)" style="border-bottom: 5px solid var(--g3-color);">
            <div class="decoration-circle" style="background: var(--g3-color);"></div>
            <div class="card-icon">ğŸ¬</div>
            <div class="card-title">3ã­ã‚“ã›ã„</div>
        </div>
        <div class="grade-card" onclick="launchGrade(4)" style="border-bottom: 5px solid var(--g4-color);">
            <div class="decoration-circle" style="background: var(--g4-color);"></div>
            <div class="card-icon">ğŸ¦</div>
            <div class="card-title">4ã­ã‚“ã›ã„</div>
        </div>
        <div class="grade-card" onclick="launchGrade(5)" style="border-bottom: 5px solid var(--g5-color);">
            <div class="decoration-circle" style="background: var(--g5-color);"></div>
            <div class="card-icon">ğŸš€</div>
            <div class="card-title">5ã­ã‚“ã›ã„</div>
        </div>
        <div class="grade-card" onclick="launchGrade(6)" style="border-bottom: 5px solid var(--g6-color);">
            <div class="decoration-circle" style="background: var(--g6-color);"></div>
            <div class="card-icon">ğŸ‘‘</div>
            <div class="card-title">6ã­ã‚“ã›ã„</div>
        </div>
    </div>

    <div class="footer-note">
        æœ¬ã‚¢ãƒ—ãƒªã®æ¼¢å­—ãƒ‡ãƒ¼ã‚¿ã¯AnimCJK/HanziWriterã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚<br>
        å­¦æ ¡ã®æŒ‡å°ã¨ç­†é †ãŒç•°ãªã‚‹å ´åˆã¯ã€å­¦æ ¡ã®æŒ‡å°ã‚’å„ªå…ˆã—ã¦ãã ã•ã„ã€‚
    </div>
  </div>

  <div id="app-screen" class="view-section" style="background-color: #FFF3E0;">
    
    <div id="subscreen-mode" class="app-container">
        <div class="mode-select-title">
            <span id="app-grade-title">X</span>ã­ã‚“ã›ã„<br>ã‚¹ã‚¿ãƒ¼ãƒˆï¼
        </div>
        <button class="mode-btn btn-practice" onclick="selectMode('practice')">
            <span>â­</span> ã‚Œã‚“ã—ã‚…ã†
        </button>
        <button class="mode-btn btn-test" onclick="selectMode('test')">
            <span>ğŸ†</span> ãƒ†ã‚¹ãƒˆ
        </button>
        <button class="mode-btn btn-back" onclick="returnToPortal()">
            ğŸ  æˆ»ã‚‹
        </button>
    </div>

    <div id="subscreen-list" class="app-container hidden">
        <div class="list-header">
            <button onclick="showSubScreen('subscreen-mode')" style="background:#B0BEC5; border:none; padding:8px 15px; border-radius:20px; color:white;">â—€ æˆ»ã‚‹</button>
            <div id="list-title" style="font-weight:bold;">ç·´ç¿’ãƒ¢ãƒ¼ãƒ‰</div>
            <div style="font-weight:bold;">â˜… <span id="star-count">0</span></div>
        </div>
        <input type="text" id="app-search" placeholder="ã“ã®å­¦å¹´ã§ã•ãŒã™" style="width:100%; padding:10px; margin-bottom:15px; border-radius:10px; border:1px solid #ccc;" oninput="filterAppList(this.value)">
        <div id="kanji-list-grid" class="kanji-grid-list"></div>
    </div>

    <div id="subscreen-practice" class="app-container hidden">
        <div style="width:100%; display:flex; justify-content:space-between; margin-bottom:10px;">
            <button onclick="showSubScreen('subscreen-list')" style="background:#B0BEC5; border:none; padding:8px 15px; border-radius:20px; color:white;">â—€ ãƒªã‚¹ãƒˆã¸</button>
            <button onclick="retryChar()" style="background:#FF7043; border:none; padding:8px 15px; border-radius:20px; color:white;">æ›¸ãç›´ã™ â†º</button>
        </div>
        
        <div class="target-reading" id="target-reading-display">èª­ã¿</div>
        <div class="message-box" id="msg-box">ãªãã£ã¦ã¿ã‚ˆã†ï¼</div>

        <div class="canvas-area">
            <div id="character-target"></div>
        </div>
    </div>

    <div id="result-overlay">
        <div class="result-emoji" id="res-emoji">ğŸ‰</div>
        <div class="result-text" id="res-text" style="color:#4CAF50;">ã§ããŸï¼</div>
        <div style="display:flex; gap:15px; flex-direction:column;">
            <button class="mode-btn btn-practice" onclick="nextChar()" style="font-size:1.1rem; width:220px;">ã¤ãã¸ â–¶</button>
            <button class="mode-btn btn-back" onclick="retryChar()" style="font-size:1.1rem; width:220px; background:#FF9800;">ã‚‚ã†ã„ã¡ã©</button>
            <button class="mode-btn btn-back" onclick="showSubScreen('subscreen-list')" style="font-size:1.1rem; width:220px;">ãƒªã‚¹ãƒˆã¸</button>
        </div>
    </div>

  </div>

  <script>
    /* =========================================
       ãƒ‡ãƒ¼ã‚¿å®šç¾© (ãƒãƒ¼ã‚¿ãƒ«å´ã®ãƒ‡ãƒ¼ã‚¿ã‚’è§£æå¯èƒ½ãªå½¢ã§ä¿æŒ)
       ========================================= */
    const rawData = `
    1|ä¸€:ã„ã¡,ã„ã¤,ã²ã¨|å³:ã†,ã‚†ã†,ã¿ã|é›¨:ã†,ã‚ã‚,ã‚ã¾|å††:ãˆã‚“,ã¾ã‚‹|ç‹:ãŠã†|éŸ³:ãŠã‚“,ã„ã‚“,ãŠã¨,ã­|ä¸‹:ã‹,ã’,ã—ãŸ,ã—ã‚‚,ã‚‚ã¨,ã•|ç«:ã‹,ã²,ã»|èŠ±:ã‹,ã¯ãª|è²:ã‹ã„|å­¦:ãŒã,ã¾ãª|æ°—:ã,ã‘|ä¹:ãã‚…ã†,ã,ã“ã“ã®|ä¼‘:ãã‚…ã†,ã‚„ã™|ç‰:ãã‚‡ã,ãŸã¾|é‡‘:ãã‚“,ã“ã‚“,ã‹ã­,ã‹ãª|ç©º:ãã†,ãã‚‰,ã‚,ã‹ã‚‰,ã™|æœˆ:ã’ã¤,ãŒã¤,ã¤ã|çŠ¬:ã‘ã‚“,ã„ã¬|è¦‹:ã‘ã‚“,ã¿|äº”:ã”,ã„ã¤|å£:ã“ã†,ã,ãã¡|æ ¡:ã“ã†|å·¦:ã•,ã²ã ã‚Š|ä¸‰:ã•ã‚“,ã¿|å±±:ã•ã‚“,ã‚„ã¾|å­:ã—,ã™,ã“,ã­|å››:ã—,ã‚ˆ,ã‚ˆã‚“,ã‚ˆã£|ç³¸:ã—,ã„ã¨|å­—:ã˜,ã‚ã–|è€³:ã˜,ã¿ã¿|ä¸ƒ:ã—ã¡,ãªãª,ãªã®|è»Š:ã—ã‚ƒ,ãã‚‹ã¾|æ‰‹:ã—ã‚…,ãš,ã¦,ãŸ|å:ã˜ã‚…ã†,ã˜ã£,ã¨ãŠ,ã¨|å‡º:ã—ã‚…ã¤,ã™ã„,ã ,ã§|å¥³:ã˜ã‚‡,ã«ã‚‡,ã«ã‚‡ã†,ãŠã‚“ãª,ã‚|å°:ã—ã‚‡ã†,ã¡ã„,ã“,ãŠ|ä¸Š:ã˜ã‚‡ã†,ã—ã‚‡ã†,ã†ãˆ,ã†ã‚,ã‹ã¿,ã‚,ã®ã¼|æ£®:ã—ã‚“,ã‚‚ã‚Š|äºº:ã˜ã‚“,ã«ã‚“,ã²ã¨|æ°´:ã™ã„,ã¿ãš|æ­£:ã›ã„,ã—ã‚‡ã†,ãŸã ,ã¾ã•|ç”Ÿ:ã›ã„,ã—ã‚‡ã†,ã„,ã†,ãŠ,ã¯,ã,ãªã¾|é’:ã›ã„,ã—ã‚‡ã†,ã‚ãŠ|å¤•:ã›ã,ã‚†ã†|çŸ³:ã›ã,ã—ã‚ƒã,ã“ã,ã„ã—|èµ¤:ã›ã,ã—ã‚ƒã,ã‚ã‹|åƒ:ã›ã‚“,ã¡|å·:ã›ã‚“,ã‹ã‚|å…ˆ:ã›ã‚“,ã•ã,ã¾|æ—©:ãã†,ã•ã£,ã¯ã‚„|è‰:ãã†,ãã•|è¶³:ãã,ã‚ã—,ãŸ|æ‘:ãã‚“,ã‚€ã‚‰|å¤§:ã ã„,ãŸã„,ãŠãŠ|ç”·:ã ã‚“,ãªã‚“,ãŠã¨ã“|ç«¹:ã¡ã,ãŸã‘|ä¸­:ã¡ã‚…ã†,ãªã‹|è™«:ã¡ã‚…ã†,ã‚€ã—|ç”º:ã¡ã‚‡ã†,ã¾ã¡|å¤©:ã¦ã‚“,ã‚ã‚,ã‚ã¾|ç”°:ã§ã‚“,ãŸ|åœŸ:ã©,ã¨,ã¤ã¡|äºŒ:ã«,ãµãŸ|æ—¥:ã«ã¡,ã˜ã¤,ã²,ã‹|å…¥:ã«ã‚…ã†,ã¯ã„,ã„|å¹´:ã­ã‚“,ã¨ã—|ç™½:ã¯ã,ã³ã‚ƒã,ã—ã‚,ã—ã‚‰|å…«:ã¯ã¡,ã‚„,ã‚„ã£,ã‚ˆã†|ç™¾:ã²ã‚ƒã,ã‚‚ã‚‚|æ–‡:ã¶ã‚“,ã‚‚ã‚“,ãµã¿|æœ¨:ã¼ã,ã‚‚ã,ã,ã“|æœ¬:ã»ã‚“,ã‚‚ã¨|å:ã‚ã„,ã¿ã‚‡ã†,ãª|ç›®:ã‚‚ã,ã¼ã,ã‚,ã¾|ç«‹:ã‚Šã¤,ã‚Šã‚…ã†,ãŸ,ã |åŠ›:ã‚Šã‚‡ã,ã‚Šã,ã¡ã‹ã‚‰|æ—:ã‚Šã‚“,ã¯ã‚„ã—|å…­:ã‚ã,ã‚€,ã‚€ã£
    2|å¼•:ã„ã‚“,ã²|ç¾½:ã†,ã¯,ã¯ã­|é›²:ã†ã‚“,ãã‚‚|åœ’:ãˆã‚“,ãã®|é :ãˆã‚“,ãŠã‚“,ã¨ãŠ|ä½•:ã‹,ãªã«,ãªã‚“|ç§‘:ã‹|å¤:ã‹,ã’,ãªã¤|å®¶:ã‹,ã‘,ã„ãˆ,ã‚„|æ­Œ:ã‹,ã†ãŸ|ç”»:ãŒ,ã‹ã|å›:ã‹ã„,ãˆ,ã¾ã‚|ä¼š:ã‹ã„,ãˆ,ã‚|æµ·:ã‹ã„,ã†ã¿|çµµ:ã‹ã„,ãˆ|å¤–:ãŒã„,ã’,ãã¨,ã»ã‹,ã¯ãš|è§’:ã‹ã,ã‹ã©,ã¤ã®|æ¥½:ãŒã,ã‚‰ã,ãŸã®|æ´»:ã‹ã¤|é–“:ã‹ã‚“,ã‘ã‚“,ã‚ã„ã ,ã¾|ä¸¸:ãŒã‚“,ã¾ã‚‹|å²©:ãŒã‚“,ã„ã‚|é¡”:ãŒã‚“,ã‹ãŠ|æ±½:ã|è¨˜:ã,ã—ã‚‹|å¸°:ã,ã‹ãˆ|å¼“:ãã‚…ã†,ã‚†ã¿|ç‰›:ãã‚…ã†,ã†ã—|é­š:ãã‚‡,ã†ãŠ,ã•ã‹ãª|äº¬:ãã‚‡ã†,ã‘ã„,ãã‚“|å¼·:ãã‚‡ã†,ã”ã†,ã¤ã‚ˆ,ã—|æ•™:ãã‚‡ã†,ãŠã—,ãŠã|è¿‘:ãã‚“,ã¡ã‹|å…„:ã‘ã„,ãã‚‡ã†,ã‚ã«|å½¢:ã‘ã„,ãã‚‡ã†,ã‹ãŸ,ã‹ãŸã¡|è¨ˆ:ã‘ã„,ã¯ã‹|å…ƒ:ã’ã‚“,ãŒã‚“,ã‚‚ã¨|è¨€:ã’ã‚“,ã”ã‚“,ã„,ã“ã¨|åŸ:ã’ã‚“,ã¯ã‚‰|æˆ¸:ã“,ã¨|å¤:ã“,ãµã‚‹|åˆ:ã”|å¾Œ:ã”,ã“ã†,ã®ã¡,ã†ã—,ã‚ã¨,ãŠã|èª:ã”,ã‹ãŸ|å·¥:ã“ã†,ã|å…¬:ã“ã†,ãŠãŠã‚„ã‘|åºƒ:ã“ã†,ã²ã‚|äº¤:ã“ã†,ã¾ã˜,ã¾,ã‹|å…‰:ã“ã†,ã²ã‹ã‚Š,ã²ã‹|è€ƒ:ã“ã†,ã‹ã‚“ãŒ|è¡Œ:ã“ã†,ãã‚‡ã†,ã‚ã‚“,ã„,ã‚†,ãŠã“ãª|é«˜:ã“ã†,ãŸã‹|é»„:ã“ã†,ãŠã†,ã,ã“|åˆ:ã”ã†,ãŒã£,ã‹ã£,ã‚|è°·:ã“ã,ãŸã«|å›½:ã“ã,ãã«|é»’:ã“ã,ãã‚|ä»Š:ã“ã‚“,ãã‚“,ã„ã¾|æ‰:ã•ã„|ç´°:ã•ã„,ã»ã,ã“ã¾|ä½œ:ã•ã,ã•,ã¤ã|ç®—:ã•ã‚“|æ­¢:ã—,ã¨,ã‚„|å¸‚:ã—,ã„ã¡|çŸ¢:ã—,ã‚„|å§‰:ã—,ã‚ã­|æ€:ã—,ãŠã‚‚|ç´™:ã—,ã‹ã¿|å¯º:ã˜,ã¦ã‚‰|è‡ª:ã˜,ã—,ã¿ãšã‹|æ™‚:ã˜,ã¨ã|å®¤:ã—ã¤,ã‚€ã‚|ç¤¾:ã—ã‚ƒ,ã‚„ã—ã‚|å¼±:ã˜ã‚ƒã,ã‚ˆã‚|é¦–:ã—ã‚…,ãã³|ç§‹:ã—ã‚…ã†,ã‚ã|é€±:ã—ã‚…ã†|æ˜¥:ã—ã‚…ã‚“,ã¯ã‚‹|æ›¸:ã—ã‚‡,ã‹|å°‘:ã—ã‚‡ã†,ã™ã,ã™ã“|å ´:ã˜ã‚‡ã†,ã°|è‰²:ã—ã‚‡ã,ã—ã,ã„ã‚|é£Ÿ:ã—ã‚‡ã,ã˜ã,ãŸ,ã|å¿ƒ:ã—ã‚“,ã“ã“ã‚|æ–°:ã—ã‚“,ã‚ãŸã‚‰,ã‚ã‚‰,ã«ã„|è¦ª:ã—ã‚“,ãŠã‚„,ã—ãŸ|å›³:ãš,ã¨,ã¯ã‹|æ•°:ã™ã†,ã™,ã‹ãš,ã‹ã|è¥¿:ã›ã„,ã•ã„,ã«ã—|å£°:ã›ã„,ã—ã‚‡ã†,ã“ãˆ,ã“ã‚|æ˜Ÿ:ã›ã„,ã—ã‚‡ã†,ã»ã—|æ™´:ã›ã„,ã¯|åˆ‡:ã›ã¤,ã•ã„,ã|é›ª:ã›ã¤,ã‚†ã|èˆ¹:ã›ã‚“,ãµã­,ãµãª|ç·š:ã›ã‚“|å‰:ãœã‚“,ã¾ãˆ|çµ„:ã,ãã¿|èµ°:ãã†,ã¯ã—|å¤š:ãŸ,ãŠãŠ|å¤ª:ãŸã„,ãŸ,ãµã¨|ä½“:ãŸã„,ã¦ã„,ã‹ã‚‰ã |å°:ã ã„,ãŸã„|åœ°:ã¡,ã˜|æ± :ã¡,ã„ã‘|çŸ¥:ã¡,ã—|èŒ¶:ã¡ã‚ƒ,ã•|æ˜¼:ã¡ã‚…ã†,ã²ã‚‹|é•·:ã¡ã‚‡ã†,ãªãŒ|é³¥:ã¡ã‚‡ã†,ã¨ã‚Š|æœ:ã¡ã‚‡ã†,ã‚ã•|ç›´:ã¡ã‚‡ã,ã˜ã,ãªãŠ,ãŸã |é€š:ã¤ã†,ã¨ãŠ,ã‹ã‚ˆ|å¼Ÿ:ã¦ã„,ã ã„,ã§,ãŠã¨ã†ã¨|åº—:ã¦ã‚“,ã¿ã›|ç‚¹:ã¦ã‚“|é›»:ã§ã‚“|åˆ€:ã¨ã†,ã‹ãŸãª|å†¬:ã¨ã†,ãµã‚†|å½“:ã¨ã†,ã‚|æ±:ã¨ã†,ã²ãŒã—|ç­”:ã¨ã†,ã“ãŸ|é ­:ã¨ã†,ãš,ãƒˆ,ã‚ãŸã¾,ã‹ã—ã‚‰|åŒ:ã©ã†,ãŠãª|é“:ã©ã†,ã¨ã†,ã¿ã¡|èª­:ã©ã,ã¨ã,ã¨ã†,ã‚ˆ|å†…:ãªã„,ã ã„,ã†ã¡|å—:ãªã‚“,ãª,ã¿ãªã¿|è‚‰:ã«ã|é¦¬:ã°,ã†ã¾,ã¾|å£²:ã°ã„,ã†|è²·:ã°ã„,ã‹|éº¦:ã°ã,ã‚€ã|åŠ:ã¯ã‚“,ãªã‹|ç•ª:ã°ã‚“|çˆ¶:ãµ,ã¡ã¡|é¢¨:ãµã†,ãµ,ã‹ãœ,ã‹ã–|åˆ†:ã¶ã‚“,ãµã‚“,ã¶,ã‚|è:ã¶ã‚“,ã‚‚ã‚“,ã|ç±³:ã¹ã„,ã¾ã„,ã“ã‚|æ­©:ã»,ã¶,ãµ,ã‚ã‚‹,ã‚ã‚†|æ¯:ã¼,ã¯ã¯|æ–¹:ã»ã†,ã‹ãŸ|åŒ—:ã»ã,ããŸ|å¦¹:ã¾ã„,ã„ã‚‚ã†ã¨|æ¯:ã¾ã„|ä¸‡:ã¾ã‚“,ã°ã‚“|æ˜:ã‚ã„,ã¿ã‚‡ã†,ã‚,ã‚ã‹,ã‚ã|é³´:ã‚ã„,ãª|æ¯›:ã‚‚ã†,ã‘|é–€:ã‚‚ã‚“,ã‹ã©|å¤œ:ã‚„,ã‚ˆ,ã‚ˆã‚‹|é‡:ã‚„,ã®|å‹:ã‚†ã†,ã¨ã‚‚|ç”¨:ã‚ˆã†,ã‚‚ã¡|æ›œ:ã‚ˆã†|æ¥:ã‚‰ã„,ã,ããŸ,ã“|é‡Œ:ã‚Š,ã•ã¨|ç†:ã‚Š|è©±:ã‚,ã¯ãªã—,ã¯ãª
    3|æ‚ª:ã‚ã,ãŠ,ã‚ã‚‹|å®‰:ã‚ã‚“,ã‚„ã™|æš—:ã‚ã‚“,ãã‚‰|åŒ»:ã„|å§”:ã„,ã‚†ã |æ„:ã„|è‚²:ã„ã,ãã |å“¡:ã„ã‚“|é™¢:ã„ã‚“|é£²:ã„ã‚“,ã®|é‹:ã†ã‚“,ã¯ã“|æ³³:ãˆã„,ãŠã‚ˆ|é§…:ãˆã|å¤®:ãŠã†|æ¨ª:ãŠã†,ã‚ˆã“|å±‹:ãŠã,ã‚„|æ¸©:ãŠã‚“,ã‚ãŸãŸ|åŒ–:ã‹,ã‘,ã°|è·:ã‹,ã«|ç•Œ:ã‹ã„|é–‹:ã‹ã„,ã²ã‚‰,ã‚|éš:ã‹ã„|å¯’:ã‹ã‚“,ã•ã‚€|æ„Ÿ:ã‹ã‚“|æ¼¢:ã‹ã‚“|é¤¨:ã‹ã‚“,ã‚„ã‹ãŸ|å²¸:ãŒã‚“,ãã—|èµ·:ã,ãŠ|æœŸ:ã|å®¢:ãã‚ƒã,ã‹ã|ç©¶:ãã‚…ã†,ãã‚|æ€¥:ãã‚…ã†,ã„ã|ç´š:ãã‚…ã†|å®®:ãã‚…ã†,ãã†,ã,ã¿ã‚„|çƒ:ãã‚…ã†,ãŸã¾|å»:ãã‚‡,ã“,ã•|æ©‹:ãã‚‡ã†,ã¯ã—|æ¥­:ãã‚‡ã†,ã”ã†,ã‚ã–|æ›²:ãã‚‡ã,ã¾|å±€:ãã‚‡ã|éŠ€:ãã‚“|åŒº:ã|è‹¦:ã,ãã‚‹,ã«ãŒ|å…·:ã|å›:ãã‚“,ãã¿|ä¿‚:ã‘ã„,ã‹ã‹,ã‹ã‹ã‚Š|è»½:ã‘ã„,ã‹ã‚‹|è¡€:ã‘ã¤,ã¡|æ±º:ã‘ã¤,ã|ç ”:ã‘ã‚“,ã¨|çœŒ:ã‘ã‚“|åº«:ã“,ã|æ¹–:ã“,ã¿ãšã†ã¿|å‘:ã“ã†,ã‚€|å¹¸:ã“ã†,ã•ã„ã‚,ã•ã¡,ã—ã‚ã‚|æ¸¯:ã“ã†,ã¿ãªã¨|å·:ã”ã†|æ ¹:ã“ã‚“,ã­|ç¥­:ã•ã„,ã¾ã¤|çš¿:ã•ã‚‰|ä»•:ã—,ã˜,ã¤ã‹|æ­»:ã—|ä½¿:ã—,ã¤ã‹|å§‹:ã—,ã¯ã˜|æŒ‡:ã—,ã‚†ã³,ã•|æ­¯:ã—,ã¯|è©©:ã—|æ¬¡:ã˜,ã—,ã¤ã|äº‹:ã˜,ãš,ã“ã¨|æŒ:ã˜,ã‚‚|å¼:ã—ã|å®Ÿ:ã˜ã¤,ã¿,ã¿ã®|å†™:ã—ã‚ƒ,ã†ã¤|è€…:ã—ã‚ƒ,ã‚‚ã®|ä¸»:ã—ã‚…,ã™,ã¬ã—,ãŠã‚‚|å®ˆ:ã—ã‚…,ã™,ã¾ã‚‚,ã‚‚ã‚Š|å–:ã—ã‚…,ã¨|é…’:ã—ã‚…,ã•ã‘,ã•ã‹|å—:ã˜ã‚…,ã†|å·:ã—ã‚…ã†,ã™|æ‹¾:ã—ã‚…ã†,ã˜ã‚…ã†,ã²ã‚|çµ‚:ã—ã‚…ã†,ãŠ|ç¿’:ã—ã‚…ã†,ãªã‚‰|é›†:ã—ã‚…ã†,ã‚ã¤|ä½:ã˜ã‚…ã†,ã™|é‡:ã˜ã‚…ã†,ã¡ã‚‡ã†,ãˆ,ãŠã‚‚,ã‹ã•|å®¿:ã—ã‚…ã,ã‚„ã©|æ‰€:ã—ã‚‡,ã¨ã“ã‚|æš‘:ã—ã‚‡,ã‚ã¤|åŠ©:ã˜ã‚‡,ãŸã™,ã™ã‘|æ˜­:ã—ã‚‡ã†|æ¶ˆ:ã—ã‚‡ã†,ã,ã‘|å•†:ã—ã‚‡ã†,ã‚ããª|ç« :ã—ã‚‡ã†|å‹:ã—ã‚‡ã†,ã‹,ã¾ã•|ä¹—:ã˜ã‚‡ã†,ã®|æ¤:ã—ã‚‡ã,ã†|ç”³:ã—ã‚“,ã‚‚ã†|èº«:ã—ã‚“,ã¿|ç¥:ã—ã‚“,ã˜ã‚“,ã‹ã¿,ã‹ã‚“|çœŸ:ã—ã‚“,ã¾|æ·±:ã—ã‚“,ãµã‹|é€²:ã—ã‚“,ã™ã™|ä¸–:ã›ã„,ã›,ã‚ˆ|æ•´:ã›ã„,ã¨ã¨ã®|æ˜”:ã›ã,ã—ã‚ƒã,ã‚€ã‹ã—|å…¨:ãœã‚“,ã¾ã£ãŸ,ã™ã¹|ç›¸:ãã†,ã—ã‚‡ã†,ã‚ã„|é€:ãã†,ãŠã|æƒ³:ãã†,ã|æ¯:ãã,ã„ã|é€Ÿ:ãã,ã¯ã‚„,ã™ã¿|æ—:ãã|ä»–:ãŸ,ã»ã‹|æ‰“:ã ,ã†|å¯¾:ãŸã„,ã¤ã„|å¾…:ãŸã„,ã¾|ä»£:ã ã„,ãŸã„,ã‹,ã‚ˆ,ã—ã‚|ç¬¬:ã ã„|é¡Œ:ã ã„|ç‚­:ãŸã‚“,ã™ã¿|çŸ­:ãŸã‚“,ã¿ã˜ã‹|è«‡:ã ã‚“|ç€:ã¡ã‚ƒã,ã˜ã‚ƒã,ã,ã¤|æ³¨:ã¡ã‚…ã†,ãã|æŸ±:ã¡ã‚…ã†,ã¯ã—ã‚‰|ä¸:ã¡ã‚‡ã†,ã¦ã„|å¸³:ã¡ã‚‡ã†|èª¿:ã¡ã‚‡ã†,ã—ã‚‰,ã¨ã¨ã®|è¿½:ã¤ã„,ãŠ|å®š:ã¦ã„,ã˜ã‚‡ã†,ã•ã |åº­:ã¦ã„,ã«ã‚|ç¬›:ã¦ã,ãµãˆ|é‰„:ã¦ã¤|è»¢:ã¦ã‚“,ã“ã‚|éƒ½:ã¨,ã¤,ã¿ã‚„ã“|åº¦:ã©,ã¨,ãŸã,ãŸã³|æŠ•:ã¨ã†,ãª|è±†:ã¨ã†,ãš,ã¾ã‚|å³¶:ã¨ã†,ã—ã¾|æ¹¯:ã¨ã†,ã‚†|ç™»:ã¨ã†,ã¨,ã®ã¼|ç­‰:ã¨ã†,ã²ã¨,ãªã©|å‹•:ã©ã†,ã†ã”|ç«¥:ã©ã†,ã‚ã‚‰ã¹|è¾²:ã®ã†|æ³¢:ã¯,ãªã¿|é…:ã¯ã„,ãã°|å€:ã°ã„|ç®±:ã¯ã“|ç•‘:ã¯ãŸ,ã¯ãŸã‘|ç™º:ã¯ã¤,ã»ã¤|å:ã¯ã‚“,ã»ã‚“,ãŸã‚“,ã|å‚:ã¯ã‚“,ã•ã‹|æ¿:ã¯ã‚“,ã„ãŸ|çš®:ã²,ã‹ã‚|æ‚²:ã²,ã‹ãª|ç¾:ã³,ã†ã¤ã|é¼»:ã³,ã¯ãª|ç­†:ã²ã¤,ãµã§|æ°·:ã²ã‚‡ã†,ã“ãŠã‚Š,ã²|è¡¨:ã²ã‚‡ã†,ãŠã‚‚ã¦,ã‚ã‚‰ã‚|ç§’:ã³ã‚‡ã†|ç—…:ã³ã‚‡ã†,ã‚„ã¾ã„,ã‚„|å“:ã²ã‚“,ã—ãª|è² :ãµ,ã¾,ãŠ|éƒ¨:ã¶|æœ:ãµã|ç¦:ãµã|ç‰©:ã¶ã¤,ã‚‚ã¤,ã‚‚ã®|å¹³:ã¸ã„,ã³ã‚‡ã†,ãŸã„,ã²ã‚‰|è¿”:ã¸ã‚“,ã‹ãˆ|å‹‰:ã¹ã‚“|æ”¾:ã»ã†,ã¯ãª|å‘³:ã¿,ã‚ã˜|å‘½:ã‚ã„,ã¿ã‚‡ã†,ã„ã®ã¡|é¢:ã‚ã‚“,ãŠã‚‚,ãŠã‚‚ã¦,ã¤ã‚‰|å•:ã‚‚ã‚“,ã¨|å½¹:ã‚„ã,ãˆã|è–¬:ã‚„ã,ãã™ã‚Š|ç”±:ã‚†,ã‚ˆã—,ã‚†ã†|æ²¹:ã‚†,ã‚ã¶ã‚‰|æœ‰:ã‚†ã†,ã†,ã‚|éŠ:ã‚†ã†,ã‚†,ã‚ã|äºˆ:ã‚ˆ|ç¾Š:ã‚ˆã†,ã²ã¤ã˜|æ´‹:ã‚ˆã†|è‘‰:ã‚ˆã†,ã¯|é™½:ã‚ˆã†,ã²|æ§˜:ã‚ˆã†,ã•ã¾|è½:ã‚‰ã,ãŠ|æµ:ã‚Šã‚…ã†,ã‚‹,ãªãŒ|æ—…:ã‚Šã‚‡,ãŸã³|ä¸¡:ã‚Šã‚‡ã†|ç·‘:ã‚Šã‚‡ã,ã‚ã,ã¿ã©ã‚Š|ç¤¼:ã‚Œã„,ã‚‰ã„|åˆ—:ã‚Œã¤|ç·´:ã‚Œã‚“,ã­|è·¯:ã‚,ã˜,ã¿ã¡|å’Œ:ã‚,ã‚„ã‚,ãªã”
    4|æ„›:ã‚ã„,ã„ã¨|æ¡ˆ:ã‚ã‚“|ä»¥:ã„,ã‚‚ã£|è¡£:ã„,ã“ã‚ã‚‚|ä½:ã„,ãã‚‰ã„|å°:ã„ã‚“,ã—ã‚‹ã—|è‹±:ãˆã„|æ „:ãˆã„,ã•ã‹|å¡©:ãˆã‚“,ã—ãŠ|å„„:ãŠã|åŠ :ã‹,ãã‚|æœ:ã‹,ã¯|è²¨:ã‹|èª²:ã‹|èŠ½:ãŒ,ã‚|æ”¹:ã‹ã„,ã‚ã‚‰ãŸ|æ¢°:ã‹ã„|å®³:ãŒã„|è¡—:ãŒã„,ã‹ã„,ã¾ã¡|å„:ã‹ã,ãŠã®ãŠã®|è¦š:ã‹ã,ãŠã¼|å®Œ:ã‹ã‚“|å®˜:ã‹ã‚“|ç®¡:ã‹ã‚“,ãã |é–¢:ã‹ã‚“,ã›ã,ã‹ã‹|è¦³:ã‹ã‚“,ã¿|é¡˜:ãŒã‚“,ã­ãŒ|å¸Œ:ã|å­£:ã|æ——:ã,ã¯ãŸ|å™¨:ã,ã†ã¤ã‚|æ©Ÿ:ã,ã¯ãŸ|è­°:ã|æ±‚:ãã‚…ã†,ã‚‚ã¨|æ³£:ãã‚…ã†,ãª|çµ¦:ãã‚…ã†|æŒ™:ãã‚‡,ã‚|æ¼:ãã‚‡,ã‚Šã‚‡ã†|å…±:ãã‚‡ã†,ã¨ã‚‚|å”:ãã‚‡ã†|é¡:ãã‚‡ã†,ã‹ãŒã¿|ç«¶:ãã‚‡ã†,ã‘ã„,ãã|æ¥µ:ãã‚‡ã,ã”ã,ãã‚|è¨“:ãã‚“|è»:ãã‚“|éƒ¡:ãã‚“|å¾„:ã‘ã„|æ™¯:ã‘ã„|èŠ¸:ã’ã„|æ¬ :ã‘ã¤,ã‹|çµ:ã‘ã¤,ã‚€ã™|å»º:ã‘ã‚“,ã“ã‚“,ãŸ|å¥:ã‘ã‚“,ã™ã“|é¨“:ã‘ã‚“|å›º:ã“,ã‹ãŸ|åŠŸ:ã“ã†,ã|å¥½:ã“ã†,ã™|å€™:ã“ã†|åº·:ã“ã†|å·®:ã•|èœ:ã•ã„,ãª|æœ€:ã•ã„,ã‚‚ã£ã¨|æ:ã–ã„|æ˜¨:ã•ã|æœ­:ã•ã¤,ãµã |åˆ·:ã•ã¤,ã™|å¯Ÿ:ã•ã¤|å‚:ã•ã‚“,ã¾ã„|ç”£:ã•ã‚“,ã†|æ•£:ã•ã‚“,ã¡|æ®‹:ã–ã‚“,ã®ã“|æ°:ã—,ã†ã˜|å¸:ã—,ã¤ã‹ã•ã©|è©¦:ã—,ã“ã“ã‚|å…:ã˜,ã“|æ²»:ã˜,ã¡,ãŠã•|è¾:ã˜,ã‚„|å¤±:ã—ã¤,ã†ã—ãª|å€Ÿ:ã—ã‚ƒã,ã‹|ç¨®:ã—ã‚…,ãŸã­|å‘¨:ã—ã‚…ã†,ã¾ã‚|ç¥:ã—ã‚…ã†,ã—ã‚…ã,ã„ã‚|é †:ã˜ã‚…ã‚“|åˆ:ã—ã‚‡,ã¯ã˜,ã¯ã¤,ã†ã„|æ¾:ã—ã‚‡ã†,ã¾ã¤|ç¬‘:ã—ã‚‡ã†,ã‚ã‚‰|å”±:ã—ã‚‡ã†,ã¨ãª|ç„¼:ã—ã‚‡ã†,ã‚„|ç…§:ã—ã‚‡ã†,ã¦|è‡£:ã—ã‚“,ã˜ã‚“|ä¿¡:ã—ã‚“|æˆ:ã›ã„,ã˜ã‚‡ã†,ãª|çœ:ã›ã„,ã—ã‚‡ã†,ã‹ãˆã‚Š|æ¸…:ã›ã„,ã—ã‚‡ã†,ãã‚ˆ|é™:ã›ã„,ã˜ã‚‡ã†,ã—ãš|å¸­:ã›ã|ç©:ã›ã,ã¤|æŠ˜:ã›ã¤,ãŠ|ç¯€:ã›ã¤,ãµã—|èª¬:ã›ã¤,ã¨|æµ…:ã›ã‚“,ã‚ã•|æˆ¦:ã›ã‚“,ã„ãã•|é¸:ã›ã‚“,ãˆã‚‰|ç„¶:ãœã‚“|äº‰:ãã†,ã‚ã‚‰ã|å€‰:ãã†,ãã‚‰|å·£:ãã†,ã™|æŸ:ãã,ãŸã°|å´:ãã,ãŒã‚|ç¶š:ãã,ã¤ã¥|å’:ãã¤|å­«:ãã‚“,ã¾ã”|å¸¯:ãŸã„,ãŠã³|éšŠ:ãŸã„|é”:ãŸã¤,ãŸã¡|å˜:ãŸã‚“|ç½®:ã¡,ãŠ|ä»²:ã¡ã‚…ã†,ãªã‹|å…†:ã¡ã‚‡ã†,ãã–|ä½:ã¦ã„,ã²ã|åº•:ã¦ã„,ãã“|çš„:ã¦ã,ã¾ã¨|å…¸:ã¦ã‚“|ä¼:ã§ã‚“,ã¤ãŸ|å¾’:ã¨|åŠª:ã©,ã¤ã¨|ç¯:ã¨ã†,ã²|åƒ:ã©ã†,ã¯ãŸã‚‰|ç‰¹:ã¨ã|ç†±:ã­ã¤,ã‚ã¤|å¿µ:ã­ã‚“|æ•—:ã¯ã„,ã‚„ã¶|æ¢…:ã°ã„,ã†ã‚|åš:ã¯ã,ã°ã|é£¯:ã¯ã‚“,ã‚ã—|é£›:ã²,ã¨|å¿…:ã²ã¤,ã‹ãªã‚‰|ç¥¨:ã²ã‚‡ã†|æ¨™:ã²ã‚‡ã†,ã—ã‚‹ã¹|ä¸:ãµ,ã¶|å¤«:ãµ,ãµã†,ãŠã£ã¨|ä»˜:ãµ,ã¤|åºœ:ãµ|å‰¯:ãµã|å…µ:ã¸ã„,ã²ã‚‡ã†|åˆ¥:ã¹ã¤,ã‚ã‹|è¾º:ã¸ã‚“,ã‚ãŸ|å¤‰:ã¸ã‚“,ã‹|ä¾¿:ã¹ã‚“,ãŸã‚ˆã‚Š|åŒ…:ã»ã†,ã¤ã¤|æ³•:ã»ã†|æœ›:ã¼ã†,ã®ã|ç‰§:ã¼ã,ã¾ã|æœ«:ã¾ã¤,ã™ãˆ|æº€:ã¾ã‚“,ã¿|æœª:ã¿|æ°‘:ã¿ã‚“,ãŸã¿|ç„¡:ã‚€,ãª|ç´„:ã‚„ã|å‹‡:ã‚†ã†,ã„ã•|è¦:ã‚ˆã†,ã„|é¤Š:ã‚ˆã†,ã‚„ã—ãª|æµ´:ã‚ˆã,ã‚|åˆ©:ã‚Š,ã|é™¸:ã‚Šã|è‰¯:ã‚Šã‚‡ã†,ã‚ˆ|æ–™:ã‚Šã‚‡ã†|é‡:ã‚Šã‚‡ã†,ã¯ã‹|è¼ª:ã‚Šã‚“,ã‚|é¡:ã‚‹ã„|ä»¤:ã‚Œã„|å†·:ã‚Œã„,ã¤ã‚|ä¾‹:ã‚Œã„,ãŸã¨|é€£:ã‚Œã‚“,ã¤ã‚‰|è€:ã‚ã†,ãŠ|åŠ´:ã‚ã†|éŒ²:ã‚ã|è³€:ãŒ|ç¾¤:ãã‚“,ã‚€|å¾³:ã¨ã|å¯Œ:ãµ,ãµã†,ã¨,ã¨ã¿|åŸ:ã˜ã‚‡ã†,ã—ã‚,ã|èŒ¨:ã„ã°,ã„ã°ã‚‰|åª›:ãˆã‚“,ã²ã‚|å²¡:ã“ã†,ãŠã‹|æ½Ÿ:ã›ã,ã‹ãŸ,ãŒãŸ|å²:ã,ã|ç†Š:ãã¾|é¦™:ã“ã†,ã‹ãŠã‚Š|ä½:ã•|åŸ¼:ã•ã„,ã•ã|å´:ã,ã•ã|æ»‹:ã˜,ã—ã’|é¹¿:ã—ã‹,ã‹|ç¸„:ã˜ã‚‡ã†,ãªã‚|äº•:ã›ã„,ã—ã‚‡ã†,ã„|æ²–:ã¡ã‚…ã†,ãŠã|æ ƒ:ã¨ã¡|å¥ˆ:ãª|æ¢¨:ã‚Š,ãªã—|é˜ª:ã¯ã‚“,ã•ã‹|é˜œ:ãµ
    5|å›²:ã„,ã‹ã“|ç´€:ã|å–œ:ã,ã‚ˆã‚ã“|æ•‘:ãã‚…ã†,ã™ã|å‹:ã‘ã„,ã‹ãŸ|èˆª:ã“ã†|å‘Š:ã“ã,ã¤|æ®º:ã•ã¤,ã“ã‚|å£«:ã—|å²:ã—|è±¡:ã—ã‚‡ã†,ãã†|è³:ã—ã‚‡ã†|è²¯:ã¡ã‚‡|åœ:ã¦ã„|å ‚:ã©ã†|å¾—:ã¨ã,ãˆ|æ¯’:ã©ã|è²»:ã²,ã¤ã„|ç²‰:ãµã‚“,ã“,ã“ãª|è„ˆ:ã¿ã‚ƒã|æ­´:ã‚Œã|åœ§:ã‚ã¤|ç§»:ã„,ã†ã¤|å› :ã„ã‚“,ã‚ˆ|æ°¸:ãˆã„,ãªãŒ|å–¶:ãˆã„,ã„ã¨ãª|è¡›:ãˆã„|æ˜“:ãˆã,ã„,ã‚„ã•|ç›Š:ãˆã,ã‚„ã|æ¶²:ãˆã|æ¼”:ãˆã‚“|å¿œ:ãŠã†,ã“ãŸ|å¾€:ãŠã†|æ¡œ:ãŠã†,ã•ãã‚‰|å¯:ã‹|ä»®:ã‹,ã‘,ã‹ã‚Š|ä¾¡:ã‹,ã‚ãŸã„|æ²³:ã‹,ã‹ã‚|é:ã‹,ã™,ã‚ã‚„ã¾|è§£:ã‹ã„,ã’,ã¨|æ ¼:ã‹ã,ã“ã†|ç¢º:ã‹ã,ãŸã—|é¡:ãŒã,ã²ãŸã„|åˆŠ:ã‹ã‚“|å¹¹:ã‹ã‚“,ã¿ã|æ…£:ã‹ã‚“,ãª|çœ¼:ãŒã‚“,ã’ã‚“,ã¾ãªã“|åŸº:ã,ã‚‚ã¨|å¯„:ã,ã‚ˆ|è¦:ã|æŠ€:ã,ã‚ã–|ç¾©:ã|é€†:ãã‚ƒã,ã•ã‹|ä¹…:ãã‚…ã†,ã²ã•|æ—§:ãã‚…ã†|å±…:ãã‚‡,ã„|è¨±:ãã‚‡,ã‚†ã‚‹|å¢ƒ:ãã‚‡ã†,ã‘ã„,ã•ã‹ã„|å‡:ãã‚“|ç¦:ãã‚“|å¥:ã|çµŒ:ã‘ã„,ãã‚‡ã†,ã¸,ãŸ|æ½”:ã‘ã¤,ã„ã•ãã‚ˆ|ä»¶:ã‘ã‚“|é™º:ã‘ã‚“,ã‘ã‚|æ¤œ:ã‘ã‚“|é™:ã’ã‚“,ã‹ã|ç¾:ã’ã‚“,ã‚ã‚‰ã‚|æ¸›:ã’ã‚“,ã¸|æ•…:ã“,ã‚†ãˆ,ãµã‚‹|å€‹:ã“|è­·:ã”,ã¾ã‚‚|åŠ¹:ã“ã†,ã|åš:ã“ã†,ã‚ã¤|è€•:ã“ã†,ãŸãŒã‚„|é‰±:ã“ã†|æ§‹:ã“ã†,ã‹ã¾|èˆˆ:ã“ã†,ãã‚‡ã†,ãŠã“|è¬›:ã“ã†|æ··:ã“ã‚“,ã¾|æŸ»:ã•|å†:ã•ã„,ã•,ãµãŸãŸ|ç½:ã•ã„,ã‚ã–ã‚|å¦»:ã•ã„,ã¤ã¾|æ¡:ã•ã„,ã¨|éš›:ã•ã„,ãã‚|åœ¨:ã–ã„,ã‚|è²¡:ã–ã„,ã•ã„|ç½ª:ã–ã„,ã¤ã¿|é›‘:ã–ã¤,ãã†|é…¸:ã•ã‚“,ã™|è³›:ã•ã‚“|æ”¯:ã—,ã•ã•|å¿—:ã—,ã“ã“ã‚ã–ã—|æ:ã—,ãˆã |å¸«:ã—|è³‡:ã—|é£¼:ã—,ã‹|ç¤º:ã˜,ã—,ã—ã‚|ä¼¼:ã˜,ã«|è­˜:ã—ã|è³ª:ã—ã¤,ã—ã¡,ãŸã¡|èˆ:ã—ã‚ƒ|è¬:ã—ã‚ƒ,ã‚ã‚„ã¾|æˆ:ã˜ã‚…,ã•ãš|ä¿®:ã—ã‚…ã†,ã—ã‚…,ãŠã•|è¿°:ã˜ã‚…ã¤,ã®|è¡“:ã˜ã‚…ã¤,ã™ã¹|æº–:ã˜ã‚…ã‚“|åº:ã˜ã‚‡|æ‹›:ã—ã‚‡ã†,ã¾ã­|è¨¼:ã—ã‚‡ã†|æ¡:ã˜ã‚‡ã†|çŠ¶:ã˜ã‚‡ã†|å¸¸:ã˜ã‚‡ã†,ã¤ã­,ã¨ã“|æƒ…:ã˜ã‚‡ã†,ãªã•|ç¹”:ã—ã‚‡ã,ã—ã,ãŠ|è·:ã—ã‚‡ã|åˆ¶:ã›ã„|æ€§:ã›ã„,ã—ã‚‡ã†|æ”¿:ã›ã„,ã—ã‚‡ã†,ã¾ã¤ã‚Šã”ã¨|å‹¢:ã›ã„,ã„ããŠ|ç²¾:ã›ã„,ã—ã‚‡ã†|è£½:ã›ã„|ç¨:ãœã„|è²¬:ã›ã,ã›|ç¸¾:ã›ã|æ¥:ã›ã¤,ã¤|è¨­:ã›ã¤,ã‚‚ã†|çµ¶:ãœã¤,ãŸ|ç¥–:ã|ç´ :ã,ã™|ç·:ãã†|é€ :ãã†,ã¤ã|åƒ:ãã†|å¢—:ãã†,ã¾,ãµ|å‰‡:ãã|æ¸¬:ãã,ã¯ã‹|å±:ãã|ç‡:ãã¤,ã‚Šã¤,ã²ã|æ:ãã‚“,ãã“|è²¸:ãŸã„,ã‹|æ…‹:ãŸã„|å›£:ã ã‚“,ã¨ã‚“|æ–­:ã ã‚“,ã“ã¨ã‚,ãŸ|ç¯‰:ã¡ã,ããš|å¼µ:ã¡ã‚‡ã†,ã¯|æ:ã¦ã„,ã•|ç¨‹:ã¦ã„,ã»ã©|é©:ã¦ã|çµ±:ã¨ã†,ã™|éŠ…:ã©ã†|å°:ã©ã†,ã¿ã¡ã³|ç‹¬:ã©ã,ã²ã¨|ä»»:ã«ã‚“,ã¾ã‹|ç‡ƒ:ã­ã‚“,ã‚‚|èƒ½:ã®ã†|ç ´:ã¯,ã‚„ã¶|çŠ¯:ã¯ã‚“,ãŠã‹|åˆ¤:ã¯ã‚“,ã°ã‚“|ç‰ˆ:ã¯ã‚“|æ¯”:ã²,ãã‚‰|è‚¥:ã²,ã“|é:ã²|å‚™:ã³,ããª|è©•:ã²ã‚‡ã†|è²§:ã²ã‚“,ã³ã‚“,ã¾ãš|å¸ƒ:ãµ,ã¬ã®|å©¦:ãµ|æ­¦:ã¶,ã‚€|å¾©:ãµã|è¤‡:ãµã|ä»:ã¶ã¤,ã»ã¨ã‘|ç·¨:ã¸ã‚“,ã‚|å¼:ã¹ã‚“|ä¿:ã»,ãŸã‚‚|å¢“:ã¼,ã¯ã‹|å ±:ã»ã†,ã‚€ã|è±Š:ã»ã†,ã‚†ãŸ|é˜²:ã¼ã†,ãµã›|è²¿:ã¼ã†|æš´:ã¼ã†,ã‚ã°|å‹™:ã‚€,ã¤ã¨|å¤¢:ã‚€,ã‚†ã‚|è¿·:ã‚ã„,ã¾ã‚ˆ|ç¶¿:ã‚ã‚“,ã‚ãŸ|è¼¸:ã‚†|ä½™:ã‚ˆ,ã‚ã¾|å®¹:ã‚ˆã†|ç•¥:ã‚Šã‚ƒã|ç•™:ã‚Šã‚…ã†,ã‚‹,ã¨|é ˜:ã‚Šã‚‡ã†|å¿«:ã‹ã„,ã“ã“ã‚ã‚ˆ
    6|èƒƒ:ã„|è…¸:ã¡ã‚‡ã†|æ©:ãŠã‚“|åˆ¸:ã‘ã‚“|æ‰¿:ã—ã‚‡ã†,ã†ã‘ãŸã¾ã‚|èˆŒ:ãœã¤,ã—ãŸ|éŠ­:ã›ã‚“,ãœã«|é€€:ãŸã„,ã—ã‚Šã|æ•µ:ã¦ã,ã‹ãŸã|ä¿µ:ã²ã‚‡ã†,ãŸã‚ã‚‰|é :ã‚ˆ,ã‚ãš|ç•°:ã„,ã“ã¨|éº:ã„|åŸŸ:ã„ã|å®‡:ã†|æ˜ :ãˆã„,ã†ã¤,ã¯|å»¶:ãˆã‚“,ã®|æ²¿:ãˆã‚“,ã|æˆ‘:ãŒ,ã‚ã‚Œ,ã‚|ç°:ã‹ã„,ã¯ã„|æ‹¡:ã‹ã|é©:ã‹ã,ã‹ã‚|é–£:ã‹ã|å‰²:ã‹ã¤,ã‚|æ ª:ã‹ã¶|å¹²:ã‹ã‚“,ã»,ã²|å·»:ã‹ã‚“,ã¾|çœ‹:ã‹ã‚“|ç°¡:ã‹ã‚“|å±:ã,ã‚ã¶,ã‚ã‚„|æœº:ã,ã¤ããˆ|è²´:ã,ã¨ã†ã¨,ãŸã£ã¨|ç–‘:ã,ã†ãŸãŒ|å¸:ãã‚…ã†,ã™|ä¾›:ãã‚‡ã†,ã,ã¨ã‚‚,ããª|èƒ¸:ãã‚‡ã†,ã‚€ã­,ã‚€ãª|éƒ·:ãã‚‡ã†,ã”ã†|å‹¤:ãã‚“,ã”ã‚“,ã¤ã¨|ç­‹:ãã‚“,ã™ã˜|ç³»:ã‘ã„|æ•¬:ã‘ã„,ã†ã‚„ã¾|è­¦:ã‘ã„|åŠ‡:ã’ã|æ¿€:ã’ã,ã¯ã’|ç©´:ã‘ã¤,ã‚ãª|çµ¹:ã‘ã‚“,ãã¬|æ¨©:ã‘ã‚“,ã”ã‚“|æ†²:ã‘ã‚“|æº:ã’ã‚“,ã¿ãªã‚‚ã¨|å³:ã’ã‚“,ã”ã‚“,ãã³,ã„ã‹|å·±:ã“,ã,ãŠã®ã‚Œ|å‘¼:ã“,ã‚ˆ|èª¤:ã”,ã‚ã‚„ã¾|å:ã“ã†,ãã•ã|å­:ã“ã†|çš‡:ã“ã†,ãŠã†|ç´…:ã“ã†,ã¹ã«,ãã‚Œãªã„|é™:ã“ã†,ãŠ,ãµ|é‹¼:ã“ã†,ã¯ãŒã­|åˆ»:ã“ã,ãã–|ç©€:ã“ã|éª¨:ã“ã¤,ã»ã­|å›°:ã“ã‚“,ã“ã¾|ç ‚:ã•,ã—ã‚ƒ,ã™ãª|åº§:ã–,ã™ã‚|æ¸ˆ:ã•ã„,ã™|è£:ã•ã„,ã•ã°,ãŸ|ç­–:ã•ã|å†Š:ã•ã¤,ã•ã|èš•:ã•ã‚“,ã‹ã„ã“|è‡³:ã—,ã„ãŸ|ç§:ã—,ã‚ãŸãã—,ã‚ãŸã—|å§¿:ã—,ã™ãŒãŸ|è¦–:ã—|è©:ã—|èªŒ:ã—|ç£:ã˜|å°„:ã—ã‚ƒ,ã„|æ¨:ã—ã‚ƒ,ã™|å°º:ã—ã‚ƒã|è‹¥:ã˜ã‚ƒã,ã«ã‚ƒã,ã‚ã‹|æ¨¹:ã˜ã‚…,ã|å:ã—ã‚…ã†,ãŠã•|å®—:ã—ã‚…ã†,ãã†|å°±:ã—ã‚…ã†,ã˜ã‚…,ã¤|è¡†:ã—ã‚…ã†,ã—ã‚…|å¾“:ã˜ã‚…ã†,ã—ã‚‡ã†,ã˜ã‚…,ã—ãŸãŒ|ç¸¦:ã˜ã‚…ã†,ãŸã¦|ç¸®:ã—ã‚…ã,ã¡ã¢|ç†Ÿ:ã˜ã‚…ã,ã†|ç´”:ã˜ã‚…ã‚“|å‡¦:ã—ã‚‡|ç½²:ã—ã‚‡|è«¸:ã—ã‚‡,ã‚‚ã‚|é™¤:ã˜ã‚‡,ã˜,ã®ã|å°†:ã—ã‚‡ã†|å‚·:ã—ã‚‡ã†,ããš,ã„ãŸ|éšœ:ã—ã‚‡ã†,ã•ã‚|è’¸:ã˜ã‚‡ã†,ã‚€|é‡:ã—ã‚“,ã¯ã‚Š|ä»:ã˜ã‚“,ã«|å‚:ã™ã„,ãŸ|æ¨:ã™ã„,ãŠ|å¯¸:ã™ã‚“|ç››:ã›ã„,ã˜ã‚‡ã†,ã‚‚,ã•ã‹|è–:ã›ã„,ã—ã‚‡ã†|èª :ã›ã„|å®£:ã›ã‚“,ã®ãŸã¾|å°‚:ã›ã‚“,ã‚‚ã£ã±|æ³‰:ã›ã‚“,ã„ãšã¿|æ´—:ã›ã‚“,ã‚ã‚‰|æŸ“:ã›ã‚“,ã,ã—|å–„:ãœã‚“,ã‚ˆ|å¥:ãã†,ã‹ãª|çª“:ãã†,ã¾ã©|å‰µ:ãã†,ã¤ã|è£…:ãã†,ã—ã‚‡ã†,ã‚ˆããŠ|å±¤:ãã†|æ“:ãã†,ã¿ã•ãŠ,ã‚ã‚„ã¤|è”µ:ãã†,ãã‚‰|è‡“:ãã†|å­˜:ãã‚“,ãã‚“|å°Š:ãã‚“,ã¨ã†ã¨,ãŸã£ã¨|å®…:ãŸã|æ‹…:ãŸã‚“,ã‹ã¤,ã«ãª|æ¢:ãŸã‚“,ã•ãŒ,ã•ã|èª•:ãŸã‚“|æ®µ:ã ã‚“|æš–:ã ã‚“,ã‚ãŸãŸ|å€¤:ã¡,ã‚ãŸã„,ã­|å®™:ã¡ã‚…ã†|å¿ :ã¡ã‚…ã†|è‘—:ã¡ã‚‡,ã„ã¡ã˜ã‚‹,ã‚ã‚‰ã‚|åº:ã¡ã‚‡ã†|é ‚:ã¡ã‚‡ã†,ã„ãŸã ã|æ½®:ã¡ã‚‡ã†,ã—ãŠ|è³ƒ:ã¡ã‚“|ç—›:ã¤ã†,ã„ãŸ|å±•:ã¦ã‚“|è¨:ã¨ã†,ã†|å…š:ã¨ã†|ç³–:ã¨ã†|å±Š:ã¨ã©|é›£:ãªã‚“,ã‚€ãšã‹,ã‹ãŸ|ä¹³:ã«ã‚…ã†,ã¡ã¡,ã¡|èª:ã«ã‚“,ã¿ã¨|ç´:ã®ã†,ãŠã•|è„³:ã®ã†|æ´¾:ã¯|æ‹:ã¯ã„,ãŠãŒ|èƒŒ:ã¯ã„,ã›,ã›ã„,ãã‚€|è‚º:ã¯ã„|ä¿³:ã¯ã„|ç­:ã¯ã‚“|æ™©:ã°ã‚“|å¦:ã²,ã„ãª|æ‰¹:ã²|ç§˜:ã²,ã²ã‚|è…¹:ãµã,ã¯ã‚‰|å¥®:ãµã‚“,ãµã‚‹|ä¸¦:ã¸ã„,ãªã¿,ãªã‚‰|é™›:ã¸ã„|é–‰:ã¸ã„,ã¨,ã—|ç‰‡:ã¸ã‚“,ã‹ãŸ|è£œ:ã»,ãŠããª|æš®:ã¼,ã|å®:ã»ã†,ãŸã‹ã‚‰|è¨ª:ã»ã†,ãŠã¨ãš,ãŸãš|äº¡:ã¼ã†,ã‚‚ã†,ãª|å¿˜:ã¼ã†,ã‚ã™|æ£’:ã¼ã†|æš:ã¾ã„|å¹•:ã¾ã,ã°ã|å¯†:ã¿ã¤|ç›Ÿ:ã‚ã„|æ¨¡:ã‚‚,ã¼|è¨³:ã‚„ã,ã‚ã‘|éƒµ:ã‚†ã†|å„ª:ã‚†ã†,ã‚„ã•,ã™ã|å¹¼:ã‚ˆã†,ãŠã•ãª|æ¬²:ã‚ˆã,ã»ã£,ã»|ç¿Œ:ã‚ˆã|ä¹±:ã‚‰ã‚“,ã¿ã |åµ:ã‚‰ã‚“,ãŸã¾ã”|è¦§:ã‚‰ã‚“|è£:ã‚Š,ã†ã‚‰|å¾‹:ã‚Šã¤,ã‚Šã¡|è‡¨:ã‚Šã‚“,ã®ã|æœ—:ã‚ã†,ã»ãŒ|è«–:ã‚ã‚“|æ®:ã`;

    // å…¨æ¼¢å­—ãƒ‡ãƒ¼ã‚¿ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé…åˆ—åŒ–
    const ALL_KANJI_DATA = [];
    rawData.trim().split('\n').forEach(line => {
        const parts = line.trim().split('|');
        const grade = parseInt(parts[0]);
        for(let i=1; i<parts.length; i++) {
            const entry = parts[i].split(':');
            ALL_KANJI_DATA.push({
                char: entry[0],
                readings: entry[1] ? entry[1].split(',') : [],
                grade: grade
            });
        }
    });

    // å­¦å¹´ã”ã¨ã®ã‚«ãƒ©ãƒ¼å®šç¾©
    const GRADE_COLORS = { 1:"#FF8A65", 2:"#FFD54F", 3:"#4FC3F7", 4:"#81C784", 5:"#BA68C8", 6:"#7986CB" };

    /* =========================================
       å¤‰æ•°ãƒ»çŠ¶æ…‹ç®¡ç†
       ========================================= */
    const STORAGE_KEY = 'kanjiMaster_v6_integrated';
    let appState = {
        currentGrade: 1,
        currentMode: 'practice', // 'practice' or 'test'
        currentChar: null,
        writer: null,
        userProgress: loadProgress()
    };

    const EVOLUTION_CHARS = ["ğŸ¥š", "ğŸ£", "ğŸ—¡ï¸", "ğŸ›¡ï¸", "ğŸ´", "ğŸ°", "ğŸ§š", "ğŸ‰", "âš”ï¸", "ğŸ‘‘", "ğŸŒŸ"];
    const MAX_XP = 50;

    /* =========================================
       å…±é€šãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
       ========================================= */
    function loadProgress() {
        const defaultData = {
            xp: 0,
            clearedPractice: {}, // { "ä¸€": true, ... }
            clearedTest: {}      // { "ä¸€": true, ... }
        };
        try {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? { ...defaultData, ...JSON.parse(data) } : defaultData;
        } catch (e) { return defaultData; }
    }

    function saveProgress() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(appState.userProgress));
        renderXPBar();
    }

    function playSound(type) {
        // ç°¡æ˜“çš„ãªWebAudioç”Ÿæˆ
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        if (!AudioContext) return;
        const ctx = new AudioContext();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);

        const now = ctx.currentTime;
        if (type === 'click') {
            osc.frequency.setValueAtTime(600, now);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start(now); osc.stop(now + 0.1);
        } else if (type === 'success') {
            osc.frequency.setValueAtTime(800, now);
            osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
            gain.gain.setValueAtTime(0.2, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            osc.start(now); osc.stop(now + 0.3);
        } else if (type === 'levelup') {
            [500, 600, 800].forEach((freq, i) => {
                const o = ctx.createOscillator();
                const g = ctx.createGain();
                o.connect(g); g.connect(ctx.destination);
                o.frequency.value = freq;
                g.gain.setValueAtTime(0.2, now + i*0.1);
                g.gain.linearRampToValueAtTime(0, now + i*0.1 + 0.1);
                o.start(now + i*0.1); o.stop(now + i*0.1 + 0.1);
            });
        }
    }

    /* =========================================
       UIåˆ¶å¾¡ï¼šXPãƒãƒ¼
       ========================================= */
    function renderXPBar() {
        const xp = appState.userProgress.xp;
        const stage = Math.min(Math.floor(xp / 5), EVOLUTION_CHARS.length - 1);
        const nextStageXp = (stage + 1) * 5;
        const currentStageXp = stage * 5;
        
        let percent = ((xp - currentStageXp) / 5) * 100;
        if(xp >= MAX_XP) percent = 100;

        document.getElementById('current-char').textContent = EVOLUTION_CHARS[stage];
        document.getElementById('current-lvl').textContent = xp;
        document.getElementById('xp-fill').style.width = percent + "%";
    }

    /* =========================================
       UIåˆ¶å¾¡ï¼šç”»é¢é·ç§»
       ========================================= */
    function showScreen(screenId) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
        window.scrollTo(0,0);
    }

    function showSubScreen(subId) {
        document.querySelectorAll('#app-screen .app-container').forEach(el => el.classList.add('hidden'));
        document.getElementById(subId).classList.remove('hidden');
        if(subId === 'subscreen-list') renderKanjiList();
    }

    /* =========================================
       æ©Ÿèƒ½ï¼šãƒãƒ¼ã‚¿ãƒ«æ¤œç´¢
       ========================================= */
    function handleGlobalSearch(query) {
        const resDiv = document.getElementById('global-search-results');
        const gridDiv = document.getElementById('grade-selection-grid');
        
        if(!query) {
            resDiv.classList.add('hidden');
            gridDiv.classList.remove('hidden');
            return;
        }

        const hits = ALL_KANJI_DATA.filter(d => 
            d.char.includes(query) || d.readings.some(r => r.includes(query))
        ).slice(0, 10);

        if(hits.length > 0) {
            resDiv.innerHTML = '';
            hits.forEach(item => {
                const card = document.createElement('div');
                card.className = 'grade-card';
                card.style.height = 'auto';
                card.style.borderBottom = `4px solid ${GRADE_COLORS[item.grade]}`;
                card.innerHTML = `
                    <div style="font-size:2rem; font-weight:bold; color:${GRADE_COLORS[item.grade]}">${item.char}</div>
                    <div style="font-size:0.8rem;">${item.grade}å¹´ç”Ÿ</div>
                    <div style="font-size:0.7rem; color:#666;">${item.readings.join(' / ')}</div>
                `;
                card.onclick = () => launchDirectPractice(item);
                resDiv.appendChild(card);
            });
            resDiv.classList.remove('hidden');
            gridDiv.classList.add('hidden');
        } else {
            resDiv.innerHTML = '<div style="grid-column:1/-1; text-align:center; color:#999;">ã¿ã¤ã‹ã‚Šã¾ã›ã‚“...</div>';
            resDiv.classList.remove('hidden');
            gridDiv.classList.add('hidden');
        }
    }

    /* =========================================
       æ©Ÿèƒ½ï¼šã‚¢ãƒ—ãƒªèµ·å‹•ãƒ•ãƒ­ãƒ¼
       ========================================= */
    function launchGrade(grade) {
        playSound('click');
        appState.currentGrade = grade;
        document.getElementById('app-grade-title').textContent = `${grade}ã­ã‚“ã›ã„`;
        
        // èƒŒæ™¯è‰²ãªã©ã‚’å­¦å¹´ã‚«ãƒ©ãƒ¼ã«å¤‰æ›´
        const color = GRADE_COLORS[grade];
        document.getElementById('app-screen').style.backgroundColor = color + "20"; // è–„ã
        
        showScreen('app-screen');
        showSubScreen('subscreen-mode');
    }

    function launchDirectPractice(item) {
        // æ¤œç´¢ã‹ã‚‰ç›´æ¥ç·´ç¿’ã¸é£›ã¶å ´åˆ
        appState.currentGrade = item.grade;
        appState.currentMode = 'practice'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
        appState.currentChar = item;
        showScreen('app-screen');
        startPractice(item);
    }

    function returnToPortal() {
        playSound('click');
        showScreen('portal-screen');
        renderXPBar(); // æ›´æ–°åæ˜ 
    }

    function selectMode(mode) {
        playSound('click');
        appState.currentMode = mode;
        const title = document.getElementById('list-title');
        const badge = document.getElementById('star-count');
        
        if(mode === 'practice') {
            title.innerText = 'â­ ã‚Œã‚“ã—ã‚…ã†';
            title.style.color = '#4CAF50';
        } else {
            title.innerText = 'ğŸ† ãƒ†ã‚¹ãƒˆ';
            title.style.color = '#F44336';
        }
        
        showSubScreen('subscreen-list');
    }

    /* =========================================
       æ©Ÿèƒ½ï¼šæ¼¢å­—ãƒªã‚¹ãƒˆç”Ÿæˆ
       ========================================= */
    function renderKanjiList(filterQuery = "") {
        const grid = document.getElementById('kanji-list-grid');
        grid.innerHTML = '';
        
        // å­¦å¹´ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        const targetData = ALL_KANJI_DATA.filter(d => d.grade === appState.currentGrade);
        
        // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        const finalData = targetData.filter(d => 
            !filterQuery || d.char.includes(filterQuery) || d.readings.some(r => r.includes(filterQuery))
        );

        // é€²æ—ã‚«ã‚¦ãƒ³ãƒˆ
        let clearedCount = 0;
        const progressMap = (appState.currentMode === 'practice') 
            ? appState.userProgress.clearedPractice 
            : appState.userProgress.clearedTest;

        finalData.forEach(item => {
            const isCleared = progressMap[item.char];
            if(isCleared) clearedCount++;

            const div = document.createElement('div');
            div.className = `kanji-item ${isCleared ? (appState.currentMode === 'practice' ? 'cleared-practice' : 'cleared-test') : ''}`;
            div.textContent = item.char;
            
            if(isCleared) {
                div.innerHTML += `<span class="mark-badge">${appState.currentMode === 'practice' ? 'â­' : 'ğŸ‘‘'}</span>`;
            }

            div.onclick = () => {
                playSound('click');
                appState.currentChar = item;
                startPractice(item);
            };
            grid.appendChild(div);
        });

        document.getElementById('star-count').innerText = `${clearedCount} / ${targetData.length}`;
    }

    function filterAppList(val) {
        renderKanjiList(val);
    }

    /* =========================================
       æ©Ÿèƒ½ï¼šHanziWriter (ç·´ç¿’ãƒ»ãƒ†ã‚¹ãƒˆ)
       ========================================= */
    function startPractice(item) {
        showSubScreen('subscreen-practice');
        document.getElementById('result-overlay').style.display = 'none';

        const isTest = (appState.currentMode === 'test');
        
        // è¡¨ç¤ºã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        const readingDiv = document.getElementById('target-reading-display');
        const msgBox = document.getElementById('msg-box');
        
        if (isTest) {
            readingDiv.textContent = item.readings.join(' / ');
            msgBox.textContent = "ã“ã®æ¼¢å­—ã‚’æ›¸ã“ã†ï¼";
            msgBox.style.color = "#D32F2F";
        } else {
            readingDiv.textContent = `${item.char} (${item.readings[0] || ''})`;
            msgBox.textContent = "ã†ã™ã„ç·šã‚’ãªãã‚ã†ï¼";
            msgBox.style.color = "#00695C";
        }

        // HanziWriteråˆæœŸåŒ–
        document.getElementById('character-target').innerHTML = '';
        
        appState.writer = HanziWriter.create('character-target', item.char, {
            width: 300, height: 300, padding: 15,
            showOutline: !isTest, // ãƒ†ã‚¹ãƒˆæ™‚ã¯ã‚¬ã‚¤ãƒ‰ãªã—
            strokeAnimationSpeed: 1, 
            delayBetweenStrokes: 200,
            radicalColor: '#168F16', 
            drawingWidth: 25,
            strokeColor: '#333',
            highlightColor: '#FF7043',
            showHintAfterMisses: isTest ? 3 : 1, // ãƒ†ã‚¹ãƒˆæ™‚ã¯å³ã—ã
            
            // ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰
            charDataLoader: (char, onComplete) => {
                fetch(`https://cdn.jsdelivr.net/gh/chanind/hanzi-writer-data-jp@master/data/${char}.json`)
                    .then(res => {
                        if (!res.ok) throw new Error('JP Data missing');
                        return res.json();
                    })
                    .then(data => onComplete(data))
                    .catch(() => {
                        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                        fetch(`https://cdn.jsdelivr.net/npm/hanzi-writer-data@2.0/${char}.json`)
                        .then(res => res.json())
                        .then(data => onComplete(data));
                    });
            }
        });

        appState.writer.quiz({
            onMistake: function() {
                msgBox.textContent = isTest ? "ã¡ãŒã†ã‚ˆï¼" : "ã“ã“ã ã‚ˆï¼";
                // ç°¡æ˜“ã‚¨ãƒ©ãƒ¼éŸ³ï¼ˆå®Ÿè£…çœç•¥å¯ï¼‰
            },
            onCorrectStroke: function() {
                msgBox.textContent = "ã„ã„ã­ï¼";
                playSound('click'); // æ­£è§£ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯éŸ³
            },
            onComplete: function(summary) {
                handleComplete();
            }
        });
    }

    function retryChar() {
        if(appState.currentChar) startPractice(appState.currentChar);
    }

    function handleComplete() {
        playSound('success');
        
        // é€²æ—ä¿å­˜
        const char = appState.currentChar.char;
        let isNewClear = false;

        if (appState.currentMode === 'practice') {
            if (!appState.userProgress.clearedPractice[char]) {
                appState.userProgress.clearedPractice[char] = true;
                appState.userProgress.xp += 1; // çµŒé¨“å€¤+1
                isNewClear = true;
            }
            document.getElementById('res-emoji').textContent = "â­";
            document.getElementById('res-text').textContent = "ã§ããŸï¼";
            document.getElementById('res-text').style.color = "#4CAF50";

        } else { // Test mode
            if (!appState.userProgress.clearedTest[char]) {
                appState.userProgress.clearedTest[char] = true;
                appState.userProgress.xp += 2; // ãƒ†ã‚¹ãƒˆã¯çµŒé¨“å€¤+2
                isNewClear = true;
            }
            document.getElementById('res-emoji').textContent = "ğŸ‘‘";
            document.getElementById('res-text').textContent = "ã™ã”ã„ï¼";
            document.getElementById('res-text').style.color = "#F44336";
        }

        saveProgress();
        if(isNewClear) playSound('levelup');

        // çµæœç”»é¢è¡¨ç¤º
        setTimeout(() => {
            document.getElementById('result-overlay').style.display = 'flex';
        }, 800);
    }

    function nextChar() {
        // æ¬¡ã®æ–‡å­—ã‚’æ¢ã™
        const targetData = ALL_KANJI_DATA.filter(d => d.grade === appState.currentGrade);
        const idx = targetData.findIndex(d => d.char === appState.currentChar.char);
        
        if (idx !== -1 && idx < targetData.length - 1) {
            appState.currentChar = targetData[idx + 1];
            startPractice(appState.currentChar);
        } else {
            alert("ã“ã®å­¦å¹´ã®æ¼¢å­—ã¯ã“ã‚Œã§ãŠã—ã¾ã„ã§ã™ï¼");
            showSubScreen('subscreen-list');
        }
    }

    function resetAllData() {
        if(confirm("ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦æ¶ˆã—ã¦ã€ãƒ¬ãƒ™ãƒ«0ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ")) {
            localStorage.removeItem(STORAGE_KEY);
            location.reload();
        }
    }

    // åˆæœŸåŒ–
    renderXPBar();

  </script>
 </body>
</html>
