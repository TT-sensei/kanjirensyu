<!doctype html>
<html lang="ja">
 <head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>å°å­¦æ ¡ã‹ã‚“ã˜ãƒã‚¹ã‚¿ãƒ¼ çµ±åˆãƒãƒ¼ã‚¿ãƒ«</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>

  <style>
        /* =========================================
           1. ãƒãƒ¼ã‚¿ãƒ«ç”»é¢ã®ã‚¹ã‚¿ã‚¤ãƒ« (å…ƒã®ã¾ã¾)
           ========================================= */
        body { box-sizing: border-box; }

        :root {
            --bg-color: #F4F7F6;
            --card-shadow: 0 10px 20px rgba(0,0,0,0.08);
            --g1-color: #FF8A65; --g2-color: #FFD54F; --g3-color: #4FC3F7;
            --g4-color: #81C784; --g5-color: #BA68C8; --g6-color: #7986CB;
        }

        /* bodyã®åŸºæœ¬è¨­å®šã¯ãƒãƒ¼ã‚¿ãƒ«ã‚’å„ªå…ˆã€‚ã‚¢ãƒ—ãƒªæ™‚ã¯JSã§ã‚¯ãƒ©ã‚¹ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ */
        body {
            font-family: 'Mochiy Pop One', sans-serif;
            background-color: var(--bg-color);
            margin: 0; padding: 0; color: #37474F;
            min-height: 100vh; overflow-y: auto; display: flex; flex-direction: column;
        }

        /* --- XPãƒãƒ¼ (ä¸Šéƒ¨) --- */
        #xp-bar-container {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            padding: 10px 15px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); z-index: 200; 
            height: 100px;
            flex-shrink: 0;
            border-bottom: 3px solid #4FC3F7;
        }
        .xp-info { display: flex; align-items: center; gap: 20px; flex-grow: 1; position: relative; }
        
        .char-icon { 
            font-size: 4.2rem;
            animation: big-bounce 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            cursor: pointer; transition: transform 0.2s;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
            padding: 5px 10px; 
            background: linear-gradient(135deg, rgba(255,255,255,0.8), rgba(200,230,255,0.4)); 
            border-radius: 20px;
            display: inline-block;
            margin-left: 5px;
        }
        .char-icon:hover { transform: scale(1.2); filter: drop-shadow(0 6px 12px rgba(79, 195, 247, 0.6)); }
        
        .xp-stats { display: flex; flex-direction: column; gap: 4px; flex-grow: 1; }
        .xp-header { display: flex; align-items: baseline; gap: 10px; }
        .xp-text { font-size: 1.1rem; color: #222; white-space: nowrap; font-weight: 700; }
        
        .xp-desc { 
            font-size: 0.75rem; color: #4FC3F7; font-weight: 700; 
            background: #E1F5FE; padding: 3px 10px; border-radius: 12px;
            display: inline-block; margin-left: 5px;
        }
        
        .xp-small { font-size: 0.85rem; color: #666; font-weight: 600; text-align: right; margin-right: 15px;}
        
        .progress-track {
            height: 18px; background: #ddd; border-radius: 9px;
            margin: 5px 15px 0 0; overflow: hidden; position: relative; box-shadow: inset 0 2px 5px rgba(0,0,0,0.15);
            width: 95%;
        }
        .progress-fill {
            height: 100%; background: linear-gradient(90deg, #4FC3F7, #29B6F6);
            width: 0%; transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1); border-radius: 8px;
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.8);
        }
        
        @keyframes big-bounce { 
            0%, 100% { transform: translateY(0) scale(1); } 
            50% { transform: translateY(-8px) scale(1.05); } 
        }

        /* --- ãƒ˜ãƒƒãƒ€ãƒ¼ & æ¤œç´¢ --- */
        header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px); 
            padding: 10px 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08); 
            z-index: 100;
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            height: 60px; 
            flex-shrink: 0;
        }

        .logo { 
            font-size: 1.3rem; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            color: #2c3e50; 
            font-weight: 700;
        }

        .search-container { 
            position: relative; 
            width: 100%; 
            max-width: 420px; 
            margin: 0 15px; 
        }
        #search-input {
            width: 100%; 
            padding: 10px 18px; 
            border-radius: 30px;
            border: 2px solid #ddd; 
            background: #f5f5f5;
            font-size: 0.95rem; 
            font-family: inherit; 
            outline: none; 
            transition: all 0.3s;
            font-weight: 600;
        }
        #search-input:focus { 
            background: #fff; 
            border-color: #4FC3F7; 
            box-shadow: 0 0 0 4px rgba(79, 195, 247, 0.25);
        }

        #search-results {
            position: absolute; 
            top: 120%; 
            left: 0; 
            width: 100%;
            background: white; 
            border-radius: 15px;
            box-shadow: 0 10px 35px rgba(0,0,0,0.2);
            max-height: 60vh; 
            overflow-y: auto;
            display: none; 
            padding: 12px; 
            box-sizing: border-box; 
            z-index: 200;
        }
        .result-card {
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            padding: 13px 16px; 
            margin-bottom: 10px; 
            border-radius: 12px; 
            cursor: pointer;
            border: 2px solid transparent; 
            transition: all 0.2s;
            background: #f8f8f8;
        }
        .result-card:hover { 
            background-color: #e8f4ff; 
            border-color: #4FC3F7;
            transform: translateX(4px);
        }
        .res-left { 
            display: flex; 
            align-items: center; 
            gap: 13px; 
        }
        .res-char { 
            font-size: 1.8rem; 
            font-weight: bold; 
            width: 42px; 
            text-align: center; 
        }
        .res-reading { 
            font-size: 0.78rem; 
            color: #888; 
            font-weight: 600;
        }
        .res-badge { 
            padding: 6px 14px; 
            border-radius: 15px; 
            color: white; 
            font-size: 0.85rem; 
            white-space: nowrap; 
            font-weight: 700;
        }

        /* --- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ --- */
        #home-screen {
            flex-grow: 1; 
            overflow-y: auto; 
            padding: 25px;
            display: flex; 
            flex-direction: column; 
            align-items: center;
        }
        .hero-text { 
            text-align: center; 
            margin: 15px 0 25px; 
        }
        .hero-title { 
            font-size: 1.7rem; 
            margin-bottom: 8px; 
            color: #1a1a1a; 
            font-weight: 800;
        }
        .hero-subtitle { 
            color: #77a3d1; 
            font-size: 0.9rem; 
            font-weight: 600;
        }

        .grade-grid {
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(135px, 1fr));
            gap: 18px; 
            width: 100%; 
            max-width: 920px; 
            padding-bottom: 25px;
        }
        @media (min-width: 600px) { 
            .grade-grid { 
                grid-template-columns: repeat(3, 1fr); 
                gap: 22px; 
            } 
        }

        .grade-card {
            background: white; 
            border-radius: 22px; 
            padding: 18px;
            text-align: center; 
            cursor: pointer; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
            transition: all 0.3s; 
            position: relative; 
            overflow: hidden;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
            height: 150px; 
            border: 2px solid transparent;
        }
        .grade-card:hover { 
            transform: translateY(-8px); 
            box-shadow: 0 15px 40px rgba(0,0,0,0.18);
        }
        .grade-card:active { transform: scale(0.94); }
        .card-icon { 
            font-size: 3.5rem; 
            margin-bottom: 10px; 
            z-index: 2; 
            transition: transform 0.3s;
        }
        .grade-card:hover .card-icon { transform: scale(1.2) rotate(5deg); }
        .card-title { 
            font-size: 1.15rem; 
            font-weight: 800; 
            color: #333; 
            z-index: 2; 
        }
        .decoration-circle {
            position: absolute; 
            width: 110px; 
            height: 110px; 
            border-radius: 50%;
            opacity: 0.12; 
            z-index: 1; 
            top: -35px; 
            right: -35px;
        }

        /* --- ä¿è­·è€…å‘ã‘ãƒãƒ¼ãƒˆ --- */
        .footer-note {
            width: 100%; 
            max-width: 800px; 
            margin-top: 25px; 
            margin-bottom: 20px;
            padding: 18px; 
            background-color: #E8F4FF; 
            border-radius: 12px;
            font-size: 0.75rem; 
            color: #446688; 
            line-height: 1.7; 
            font-family: sans-serif;
            border-left: 4px solid #4FC3F7;
        }

        /* --- è‘—ä½œæ¨©ãƒ»ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ --- */
        .app-credits-container {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            width: 100%;
            max-width: 800px;
            margin: 0 auto 30px auto;
            padding: 20px;
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            color: #333;
            line-height: 1.6;
            box-sizing: border-box;
        }

        .credit-warning-box {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 25px;
        }
        .credit-warning-title {
            font-weight: bold;
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        .credit-warning-icon {
            margin-right: 8px;
            font-size: 1.2em;
        }
        .credit-section-title {
            font-size: 1.2em;
            border-bottom: 2px solid #eee;
            padding-bottom: 8px;
            margin-bottom: 15px;
            margin-top: 0;
        }
        .credit-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .credit-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px dashed #eee;
        }
        .credit-item:last-child { border-bottom: none; }
        .credit-name {
            font-weight: bold;
            font-size: 1.05em;
            color: #2c3e50;
        }
        .credit-desc {
            font-size: 0.9em;
            color: #555;
            margin-top: 5px;
            margin-left: 15px;
        }
        .credit-link {
            color: #007bff;
            text-decoration: none;
        }
        .credit-link:hover { text-decoration: underline; }
        .license-details {
            margin-top: 10px;
            font-size: 0.85em;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .license-summary {
            background-color: #f7f7f7;
            padding: 10px;
            cursor: pointer;
            font-weight: bold;
            color: #555;
            outline: none;
        }
        .license-summary:hover { background-color: #eee; }
        .license-full-text {
            padding: 15px;
            background-color: #fafafa;
            white-space: pre-wrap;
            font-family: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace;
            max-height: 300px;
            overflow-y: auto;
            border-top: 1px solid #ddd;
            color: #444;
            font-size: 0.9em;
        }

        /* --- è¨­å®šã‚¨ãƒªã‚¢ --- */
        .settings-area {
            width: 100%;
            max-width: 850px;
            margin-bottom: 80px;
            display: flex;
            justify-content: flex-end;
        }
        #reset-btn {
            background: #FFEBEE;
            border: 1px solid #FFCDD2;
            color: #D32F2F;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 700;
            font-family: inherit;
            transition: all 0.2s;
        }
        #reset-btn:hover { background: #FFCDD2; }

        /* --- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒœã‚¿ãƒ³ --- */
        #change-course-btn {
            position: fixed; 
            bottom: 20px; 
            right: 20px;
            background: linear-gradient(135deg, #fff 0%, #f0f5ff 100%);
            border: 2px solid #4FC3F7; 
            border-radius: 30px;
            padding: 12px 18px; 
            font-family: inherit; 
            font-size: 0.9rem; 
            color: #333;
            cursor: pointer; 
            box-shadow: 0 6px 18px rgba(79, 195, 247, 0.25); 
            z-index: 300;
            display: flex; 
            align-items: center; 
            gap: 7px; 
            font-weight: 700;
            transition: all 0.3s;
        }
        #change-course-btn:hover { 
            transform: translateY(-4px);
            box-shadow: 0 10px 28px rgba(79, 195, 247, 0.4);
            border-color: #29B6F6;
        }
        #change-course-btn:active { transform: scale(0.93); }

        /* --- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ --- */
        @keyframes xp-gain {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-60px) scale(1.4); }
        }
        .xp-gain-effect {
            position: fixed; 
            pointer-events: none;
            font-weight: 800; 
            color: #29B6F6;
            font-size: 1.5rem; 
            animation: xp-gain 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            text-shadow: 0 0 15px rgba(79, 195, 247, 0.8);
            z-index: 999;
        }

        #levelup-popup {
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #FFD54F 0%, #FFCA28 100%);
            padding: 35px 50px; 
            border-radius: 25px; 
            text-align: center;
            box-shadow: 0 15px 50px rgba(0,0,0,0.35);
            z-index: 1000; 
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 4px solid #fff;
        }
        #levelup-popup.show { transform: translate(-50%, -50%) scale(1); }
        .levelup-text { 
            font-size: 1.6rem; 
            color: #fff; 
            margin: 12px 0; 
            text-shadow: 0 4px 8px rgba(0,0,0,0.25);
            font-weight: 800;
        }
        .levelup-emoji { 
            font-size: 3.5rem; 
            animation: levelup-bounce 0.7s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes levelup-bounce {
            0% { transform: scale(0); }
            70% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }

        /* --- ã‚³ãƒ¼ã‚¹é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« --- */
        #course-modal {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            background: rgba(0,0,0,0.55); 
            display: none; 
            align-items: center; 
            justify-content: center;
            z-index: 1000; 
            backdrop-filter: blur(4px);
        }
        .modal-content {
            background: white; 
            padding: 30px; 
            border-radius: 25px;
            width: 90%; 
            max-width: 420px; 
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .modal-title { 
            font-size: 1.4rem; 
            margin-bottom: 22px; 
            color: #1a1a1a; 
            font-weight: 800;
        }
        .course-option {
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            background: #f5f5f5; 
            padding: 16px; 
            margin-bottom: 12px;
            border-radius: 14px; 
            cursor: pointer; 
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        .course-option:hover { 
            background: #efefef;
            transform: translateX(5px);
        }
        .course-option.active { 
            border-color: #4FC3F7; 
            background: linear-gradient(135deg, #E1F5FE, #B3E5FC);
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.25);
        }
        .co-icon { font-size: 2rem; }
        .co-name { 
            font-weight: 800; 
            font-size: 1rem; 
            text-align: left; 
            flex-grow: 1; 
            margin-left: 14px; 
            color: #222;
        }
        .co-level { 
            font-size: 0.85rem; 
            color: #888; 
            font-weight: 700;
        }
        .co-status { 
            font-size: 0.85rem; 
            font-weight: 700; 
            color: #4FC3F7;
        }

        #modal-close-btn {
            margin-top: 18px; 
            padding: 12px 28px; 
            border-radius: 22px; 
            border: none;
            background: #4FC3F7; 
            color: white; 
            font-family: inherit; 
            font-weight: 700;
            cursor: pointer; 
            transition: all 0.2s;
            font-size: 0.95rem;
        }
        #modal-close-btn:hover { 
            background: #29B6F6;
            transform: translateY(-2px);
        }

        /* --- ãƒªã‚»ãƒƒãƒˆç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« --- */
        #reset-confirm-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.55);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1100;
            backdrop-filter: blur(4px);
        }
        .reset-modal-content {
            background: white;
            padding: 30px;
            border-radius: 25px;
            width: 90%;
            max-width: 380px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .reset-modal-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #D32F2F;
            font-weight: 800;
        }
        .reset-modal-message {
            font-size: 0.95rem;
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .reset-button-group {
            display: flex;
            gap: 12px;
            justify-content: center;
        }
        .reset-confirm-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 22px;
            border: none;
            font-family: inherit;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .reset-cancel-btn {
            background: #f0f0f0;
            color: #666;
        }
        .reset-cancel-btn:hover { background: #e0e0e0; }
        .reset-ok-btn {
            background: #FF6B6B;
            color: white;
        }
        .reset-ok-btn:hover {
            background: #D32F2F;
            transform: translateY(-2px);
        }

        @media (max-width: 480px) {
            .hero-title { font-size: 1.4rem; }
            .card-icon { font-size: 3rem; }
            .card-title { font-size: 1rem; }
            #xp-bar-container { height: 90px; }
            .char-icon { font-size: 3.5rem; }
            .xp-desc { font-size: 0.65rem; }
        }

        /* =========================================
           2. ã‚¢ãƒ—ãƒªç”»é¢ (Grade App) ã®è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ«
           ========================================= */
        /* ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã®èƒŒæ™¯åˆ‡ã‚Šæ›¿ãˆç”¨ */
        body.app-mode {
            background-color: #FFF3E0 !important;
            overflow-x: hidden;
            touch-action: manipulation;
            user-select: none;
        }
        
        /* ã‚¢ãƒ—ãƒªç”¨ã‚³ãƒ³ãƒ†ãƒŠï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ */
        #app-view {
            display: none;
            width: 100%;
            min-height: 100vh;
        }

        /* ç”»é¢åˆ‡ã‚Šæ›¿ãˆ (Appå†…) */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center; justify-content: center;
            width: 100%; min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            opacity: 0; transition: opacity 0.3s;
        }
        .screen.active { display: flex; opacity: 1; }

        /* ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ (App) */
        #title-screen-app { 
            background: linear-gradient(135deg, #FFD54F 0%, #FFB74D 50%, #FFAB91 100%);
            position: relative;
            overflow: hidden;
        }
        #title-screen-app::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        .game-title {
            font-size: 3rem; color: #FFF;
            text-shadow: 3px 3px 0 #BF360C, -1px -1px 0 #FFE082;
            text-align: center; margin-bottom: 40px;
            animation: titleBounce 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }
        @keyframes titleBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .mode-btn {
            width: 280px; font-size: 1.5rem; padding: 15px 0;
            border-radius: 50px; border: none; cursor: pointer;
            margin: 10px 0; color: white; display: flex;
            align-items: center; justify-content: center; gap: 10px;
            box-shadow: 0 6px 0 rgba(0,0,0,0.2), 0 0 20px rgba(255,255,255,0.3);
            font-family: inherit;
            transition: all 0.2s ease;
            position: relative;
        }
        .mode-btn:hover {
            box-shadow: 0 6px 0 rgba(0,0,0,0.2), 0 0 30px rgba(255,255,255,0.5), inset 0 0 20px rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .mode-btn:active { transform: scale(0.95) translateY(2px); box-shadow: 0 3px 0 rgba(0,0,0,0.2); }
        .btn-practice { background: linear-gradient(135deg, #66BB6A 0%, #4CAF50 100%); }
        .btn-test { background: linear-gradient(135deg, #EF5350 0%, #F44336 100%); }
        .btn-exit { background: linear-gradient(135deg, #78909C 0%, #546E7A 100%); margin-top: 20px; font-size: 1rem; width: 150px; padding: 10px 0; }

        /* ãƒªã‚¹ãƒˆç”»é¢ (App) */
        #list-screen { justify-content: flex-start; padding-top: 20px; background: #FFF3E0; }
        .header-info {
            background: white; padding: 15px; border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px;
            display: flex; flex-direction: column; align-items: center;
            width: 90%; max-width: 600px;
        }
        .mode-badge {
            font-size: 1rem; padding: 5px 15px; border-radius: 20px;
            color: white; margin-bottom: 5px; font-weight: bold;
        }
        #app-search-box {
            width: 100%; padding: 10px; font-size: 1.2rem;
            border: 2px solid #FFCC80; border-radius: 10px;
            margin-top: 10px; text-align: center; background: #FFF8E1;
            font-family: inherit;
        }
        .kanji-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(65px, 1fr));
            gap: 12px; width: 100%; max-width: 800px; padding-bottom: 50px;
        }
        .kanji-card {
            background: linear-gradient(135deg, #FFFFFF 0%, #FFF9E6 100%);
            aspect-ratio: 1; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; cursor: pointer; position: relative;
            box-shadow: 0 4px 0 #D7CCC8, 0 0 15px rgba(255,200,124,0.3);
            border: 2px solid #FFE0B2;
            transition: all 0.2s ease;
        }
        .kanji-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 0 #D7CCC8, 0 0 20px rgba(255,152,0,0.4);
        }
        .kanji-card:active { transform: translateY(2px); box-shadow: 0 2px 0 #D7CCC8; }
        .mark {
            position: absolute; top: -8px; right: -8px; font-size: 1.2rem;
            text-shadow: 1px 1px 0 #FFF; display: none;
        }
        .cleared-practice { 
            background: linear-gradient(135deg, #F1F8E9 0%, #E8F5E9 100%);
            border-color: #8BC34A;
            box-shadow: 0 4px 0 #558B2F, 0 0 20px rgba(139,195,74,0.4) !important;
        }
        .cleared-practice .star-mark { display: block; animation: starSparkle 0.6s ease-out; }
        .cleared-test { 
            background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);
            border-color: #EF5350;
            box-shadow: 0 4px 0 #C62828, 0 0 20px rgba(239,83,80,0.4) !important;
        }
        .cleared-test .crown-mark { display: block; animation: crownSpin 0.6s ease-out; }
        @keyframes starSparkle {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.3) rotate(10deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        @keyframes crownSpin {
            0% { transform: scale(0) rotateZ(-180deg); opacity: 0; }
            50% { transform: scale(1.3) rotateZ(10deg); opacity: 1; }
            100% { transform: scale(1) rotateZ(0deg); opacity: 1; }
        }

        /* ç·´ç¿’ç”»é¢ (App) */
        #practice-screen { background: #E0F7FA; position: relative; }
        #practice-screen.test-bg { background: #FFEBEE; }
        .practice-header {
            width: 100%; max-width: 500px; display: flex;
            justify-content: space-between; align-items: center; margin-bottom: 20px;
        }
        .nav-btn {
            background: #607D8B; color: white; border: none; padding: 8px 16px;
            border-radius: 20px; box-shadow: 0 3px 0 #455A64; font-family: inherit;
            cursor: pointer;
        }
        .nav-btn:active { transform: translateY(2px); }
        .target-char-display {
            font-size: 1.8rem; color: #006064; font-weight: bold; white-space: nowrap;
        }
        .canvas-container {
            background: white; padding: 15px; border-radius: 20px;
            box-shadow: 0 8px 0 #B0BEC5; margin-bottom: 20px; position: relative;
        }
        #character-target-div { width: 300px; height: 300px; touch-action: none; }
        #message-area { height: 40px; font-size: 1.2rem; font-weight: bold; text-align: center; }

        /* çµæœãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— (App) */
        #result-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); display: none;
            flex-direction: column; align-items: center; justify-content: center;
            z-index: 200;
        }
        #result-overlay.active { display: flex; }
        .result-btn {
            width: 240px; padding: 15px; margin: 10px 0; border: none;
            border-radius: 50px; font-size: 1.3rem; color: white;
            box-shadow: 0 5px 0 rgba(0,0,0,0.2); font-family: inherit; cursor: pointer;
        }
        .result-btn:active { transform: scale(0.95); }
        .btn-next { background: #4CAF50; }
        .btn-retry { background: #FF9800; }
        .btn-home { background: #607D8B; }

        /* Appã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes popAndBounce {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.3); }
            70% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }
        .reward-animation {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); font-size: 10rem;
            animation: popAndBounce 0.6s ease-out; pointer-events: none;
            display: none; z-index: 100; text-shadow: 0 0 30px rgba(255, 255, 255, 1),
                                                   0 0 60px rgba(255, 150, 0, 0.6);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
        }
    </style>
 </head>
 <body>
  
  <div id="portal-view">
      <div id="xp-bar-container">
       <div class="xp-info">
        <div class="char-icon" id="current-char" onclick="openCourseModal()" title="ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ¼ã‚¹å¤‰æ›´ï¼">
         ğŸ¥š
        </div>
        <div class="xp-stats">
         <div class="xp-header">
          <div class="xp-text">
           Lv.<span id="current-lvl">0</span> / 50
          </div>
          <div class="xp-desc">
           ã¾ã„ã«ã¡ ã¹ã‚“ãã‚‡ã†ã™ã‚‹ã¨ ãŸã¾ã‚‹ã‚ˆï¼ï¼ˆ1æ—¥5å›ã¾ã§ï¼‰
          </div>
         </div>
         <div class="progress-track">
          <div class="progress-fill" id="xp-fill"></div>
         </div>
         <div class="xp-small">
          ã‚ã¨<span id="next-xp">5</span>å›
         </div>
        </div>
       </div>
      </div>
      <header>
       <div class="logo">
        <span>ğŸ«</span> æ¼¢å­—ãƒã‚¹ã‚¿ãƒ¼
       </div>
       <div class="search-container"><input type="text" id="search-input" placeholder="ã‹ã‚“ã˜ãƒ»ã‚ˆã¿ï¼ˆä¾‹ï¼šã‹ãŸï¼‰" autocomplete="off">
        <div id="search-results"></div>
       </div>
      </header>
      <div id="home-screen">
       <div class="hero-text">
        <div class="hero-title">
         ã©ã®å­¦å¹´ã‚’ã¯ã˜ã‚ã‚‹ï¼Ÿ
        </div>
        <div class="hero-subtitle">
         å…¨1026æ–‡å­— ã²ã‚‰ãŒãªæ¤œç´¢å¯¾å¿œä¸­ï¼
        </div>
       </div>
       <div class="grade-grid">
        <div class="grade-card" onclick="launchApp(1)" style="border-bottom: 5px solid var(--g1-color);">
         <div class="decoration-circle" style="background: var(--g1-color);"></div>
         <div class="card-icon">
          ğŸ£
         </div>
         <div class="card-title">
          1ã­ã‚“ã›ã„
         </div>
        </div>
        <div class="grade-card" onclick="launchApp(2)" style="border-bottom: 5px solid var(--g2-color);">
         <div class="decoration-circle" style="background: var(--g2-color);"></div>
         <div class="card-icon">
          ğŸ¹
         </div>
         <div class="card-title">
          2ã­ã‚“ã›ã„
         </div>
        </div>
        <div class="grade-card" onclick="launchApp(3)" style="border-bottom: 5px solid var(--g3-color);">
         <div class="decoration-circle" style="background: var(--g3-color);"></div>
         <div class="card-icon">
          ğŸ¬
         </div>
         <div class="card-title">
          3ã­ã‚“ã›ã„
         </div>
        </div>
        <div class="grade-card" onclick="launchApp(4)" style="border-bottom: 5px solid var(--g4-color);">
         <div class="decoration-circle" style="background: var(--g4-color);"></div>
         <div class="card-icon">
          ğŸ¦
         </div>
         <div class="card-title">
          4ã­ã‚“ã›ã„
         </div>
        </div>
        <div class="grade-card" onclick="launchApp(5)" style="border-bottom: 5px solid var(--g5-color);">
         <div class="decoration-circle" style="background: var(--g5-color);"></div>
         <div class="card-icon">
          ğŸš€
         </div>
         <div class="card-title">
          5ã­ã‚“ã›ã„
         </div>
        </div>
        <div class="grade-card" onclick="launchApp(6)" style="border-bottom: 5px solid var(--g6-color);">
         <div class="decoration-circle" style="background: var(--g6-color);"></div>
         <div class="card-icon">
          ğŸ‘‘
         </div>
         <div class="card-title">
          6ã­ã‚“ã›ã„
         </div>
        </div>
       </div>
       
       <div class="footer-note">
        <strong>âš ï¸ ä¿è­·è€…ãƒ»å…ˆç”Ÿæ–¹ã¸</strong><br>
        æœ¬ã‚¢ãƒ—ãƒªã¯ã€æ•™å“¡ãŒå­¦ç¿’æ”¯æ´ã®ãŸã‚ã«è‡ªä½œã—ãŸã‚‚ã®ã§ã™ï¼ˆå¤–éƒ¨ã®æ•™æã‚µã‚¤ãƒˆCanvaã¸ãƒªãƒ³ã‚¯ã—ã¾ã™ï¼‰ã€‚<br>
        æ¼¢å­—ã®ãƒ‡ãƒ¼ã‚¿ã¯æ—¥æœ¬ã®å­¦ç¿’æŒ‡å°è¦é ˜ï¼ˆå…¨1026å­—ï¼‰ã‚’å‚ç…§ã—ã¦ã„ã¾ã™ã€‚

        <div style="margin-top: 10px; padding: 8px; background-color: #f9f9f9; border-left: 4px solid #ffcc00;">
            <strong>ã€åˆ¤å®šã«é–¢ã™ã‚‹ã”æ³¨æ„ã€‘</strong><br>
            ãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«ã®æ¨™æº–å­—ä½“ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ä¸€éƒ¨ã®æ¼¢å­—ã§æ•™ç§‘æ›¸ã¨ç•°ãªã‚‹å½¢ï¼ˆç³¸ã¸ã‚“ã®ä¸‹ãŒã€Œä¸‰æœ¬ç‚¹ã€ã«ãªã‚‹ç­‰ï¼‰ãŒè¡¨ç¤ºãƒ»åˆ¤å®šã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
            ãƒ»<strong>å­¦æ ¡ã§ç¿’ã£ãŸæ›¸ãæ–¹ãŒæœ€ã‚‚æ­£ã—ã„åŸºæº–ã§ã™ã€‚</strong>ã‚¢ãƒ—ãƒªã®åˆ¤å®šã¯ã‚ãã¾ã§ç›®å®‰ã¨ã—ã¦ã”æ´»ç”¨ãã ã•ã„ã€‚
        </div>
       </div>

       <div class="app-credits-container">
        <div class="credit-warning-box">
            <div class="credit-warning-title">
                <span class="credit-warning-icon">âš ï¸</span> ç­†é †ï¼ˆæ›¸ãé †ï¼‰ã«ã¤ã„ã¦
            </div>
            <div>
                æœ¬ã‚¢ãƒ—ãƒªã§ã¯æ—¥æœ¬ã®æ¨™æº–çš„ãªç­†é †ã‚’å„ªå…ˆã—ã¦è¡¨ç¤ºã—ã¦ã„ã¾ã™ãŒã€ä¸€éƒ¨ã®æ¼¢å­—ã§ãƒ‡ãƒ¼ã‚¿ã®éƒ½åˆä¸Šã€ä¸­å›½èªç”±æ¥ã®ç­†é †ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
                <strong>å­¦æ ¡ã®æ•™ç§‘æ›¸ã‚„å…ˆç”Ÿã®æŒ‡å°ã¨ç•°ãªã‚‹å ´åˆã¯ã€æ•™ç§‘æ›¸ã‚’æ­£è§£ã¨ã—ã¦ãã ã•ã„ã€‚</strong>
            </div>
        </div>

        <h3 class="credit-section-title">ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</h3>
        <ul class="credit-list">
            <li class="credit-item">
                <div class="credit-name">1. æ—¥æœ¬èªæ¼¢å­—ãƒ‡ãƒ¼ã‚¿ (hanzi-writer-data-jp)</div>
                <div class="credit-desc">
                    â€¢ Source: <a href="https://github.com/chanind/hanzi-writer-data-jp" target="_blank" class="credit-link">GitHub Repository</a><br>
                    â€¢ Derived from <strong>AnimCJK</strong> project<br>
                    â€¢ Licensed under <strong>LGPL v3</strong> or later.<br>
                    â€¢ Original Glyph Data: <strong>Arphic Public License</strong>
                </div>
            </li>
            <li class="credit-item">
                <div class="credit-name">2. äºˆå‚™æ¼¢å­—ãƒ‡ãƒ¼ã‚¿ (hanzi-writer-data)</div>
                <div class="credit-desc">
                    â€¢ Source: <a href="https://github.com/chanind/hanzi-writer-data" target="_blank" class="credit-link">GitHub Repository</a><br>
                    â€¢ Licensed under <strong>GPL v3</strong>
                </div>
            </li>
            <li class="credit-item">
                <div class="credit-name">3. è¡¨ç¤ºãƒ©ã‚¤ãƒ–ãƒ©ãƒª</div>
                <div class="credit-desc">
                    â€¢ <strong>Hanzi Writer</strong>: <a href="https://chanind.github.io/hanzi-writer/" target="_blank" class="credit-link">Official Site</a>
                </div>
            </li>
        </ul>
       </div>

       <div class="settings-area"><button id="reset-btn" onclick="showResetConfirm()">ğŸ—‘ï¸ ãƒ‡ãƒ¼ã‚¿ã‚’ã‘ã™ï¼ˆãƒªã‚»ãƒƒãƒˆï¼‰</button>
       </div>
      </div><button id="change-course-btn" onclick="openCourseModal()"><span>ğŸ®</span> ã‚³ãƒ¼ã‚¹ã‚’ã‹ãˆã‚‹</button>
      <div id="levelup-popup">
       <div class="levelup-emoji" id="levelup-emoji">
        âœ¨
       </div>
       <div class="levelup-text">
        ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼
       </div>
       <div class="levelup-text" style="font-size: 1.2rem; opacity: 0.95;" id="levelup-char"></div>
      </div>
      <div id="course-modal" onclick="closeCourseModal(event)">
       <div class="modal-content">
        <div class="modal-title">
         ğŸ® ã‚³ãƒ¼ã‚¹ã‚’ãˆã‚‰ã‚“ã§ã­
        </div>
        <div id="course-list"></div><button id="modal-close-btn" onclick="document.getElementById('course-modal').style.display='none'">ã¨ã˜ã‚‹</button>
       </div>
      </div><div id="reset-confirm-overlay">
       <div class="reset-modal-content">
        <div class="reset-modal-title">
         âš ï¸ ã»ã‚“ã¨ã†ã« ã‘ã—ã¾ã™ã‹ï¼Ÿ
        </div>
        <div class="reset-modal-message">
         ãƒ¬ãƒ™ãƒ«ãŒ 0 ã« ãªã‚Šã¾ã™ã€‚<br>
          ã“ã®æ“ä½œã¯ ã‚‚ã©ã›ã¾ã›ã‚“ã€‚
        </div>
        <div class="reset-button-group"><button class="reset-confirm-btn reset-cancel-btn" onclick="cancelReset()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button> <button class="reset-confirm-btn reset-ok-btn" onclick="confirmReset()">ãƒ‡ãƒ¼ã‚¿ã‚’ã‘ã™</button>
        </div>
       </div>
      </div>
  </div>

  <div id="app-view">
      <div id="title-screen-app" class="screen active">
       <div class="game-title">
        1ã­ã‚“ã›ã„<br>
        ã‹ã‚“ã˜<br>
        ãƒã‚¹ã‚¿ãƒ¼ v2
       </div>
       <button class="mode-btn btn-practice" onclick="selectMode('practice')"><span>â­</span> ã‚Œã‚“ã—ã‚…ã†</button> 
       <button class="mode-btn btn-test" onclick="selectMode('test')"><span>ğŸ†</span> ãƒ†ã‚¹ãƒˆ</button>
       <button class="mode-btn btn-exit" onclick="exitApp()">ãƒãƒ¼ã‚¿ãƒ«ã¸ã‚‚ã©ã‚‹</button>
      </div>
      
      <div id="list-screen" class="screen">
       <div class="header-info">
        <div id="mode-display" class="mode-badge"></div>
        <div>
         ã‚ã¤ã‚ãŸæ•°ï¼š<span id="star-counter" style="font-weight:bold;">0</span> / <span id="max-count">80</span>
        </div><input type="text" id="app-search-box" placeholder="ã‘ã‚“ã•ãï¼ˆã‚ˆã¿ãƒ»ã‹ã‚“ã˜ï¼‰" oninput="filterAppList()"> <button class="nav-btn" onclick="showAppScreen('title-screen-app')" style="margin-top:10px;">ã‚¿ã‚¤ãƒˆãƒ«ã¸</button>
       </div>
       <div class="kanji-grid" id="kanji-grid"></div>
       <button class="nav-btn" onclick="resetAppData()" style="margin-top:30px; background:#B0BEC5; font-size:0.8rem;">ã“ã®å­¦å¹´ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆã™</button>
      </div>
      
      <div id="practice-screen" class="screen">
       <div class="practice-header"><button class="nav-btn" onclick="showAppScreen('list-screen')">ã‚‚ã©ã‚‹</button>
        <div id="current-reading" class="target-char-display">
         ã‚ˆã¿
        </div>
        <div style="width: 60px;"></div>
       </div>
       <div class="canvas-container">
        <div id="character-target-div"></div>
        <div id="anim-star" class="reward-animation">
         â­
        </div>
        <div id="anim-crown" class="reward-animation">
         ğŸ‘‘
        </div>
       </div>
       <div id="message-area">
        ãªãã£ã¦ã¿ã‚ˆã†ï¼
       </div>
       <div id="result-overlay">
        <div class="result-title" id="result-title-text" style="font-size:2.5rem; margin-bottom:20px;">
         ã§ããŸï¼
        </div><button class="result-btn btn-next" onclick="goNext()">ã¤ãã¸ â–¶</button> <button class="result-btn btn-retry" onclick="retry()">ã‚‚ã†ã„ã¡ã© â†º</button> <button class="result-btn btn-home" onclick="showAppScreen('list-screen')">ãƒ›ãƒ¼ãƒ  ğŸ </button>
       </div><button class="nav-btn" onclick="retry()" style="background:#FF7043; margin-top:10px; z-index:10;">æ›¸ãç›´ã™</button>
      </div>
  </div>

  <script>
        // =========================================
        // 1. ãƒãƒ¼ã‚¿ãƒ« (Portal) Logic
        // =========================================
        const MAX_LEVEL = 50;
        const EVOLUTION_STEP = 5;
        const MAX_DAILY_XP = 5;

        const COURSES = {
            A: {
                name: "å†’é™ºã‚³ãƒ¼ã‚¹",
                chars: ["ğŸ¥š", "ğŸ£", "ğŸ—¡ï¸", "ğŸ›¡ï¸", "ğŸ´", "ğŸ°", "ğŸ§š", "ğŸ‰", "âš”ï¸", "ğŸ‘‘", "ğŸŒŸ"]
            },
            B: {
                name: "è‡ªç„¶ã‚³ãƒ¼ã‚¹",
                chars: ["ğŸŒ±", "ğŸ’§", "ğŸŒ¿", "ğŸ€", "ğŸ„", "ğŸŒ·", "ğŸŒ»", "ğŸŒ³", "ğŸ", "ğŸ¥§", "ğŸŒˆ"]
            },
            C: {
                name: "ä¹—ç‰©ã‚³ãƒ¼ã‚¹",
                chars: ["ğŸš¶", "ğŸ›´", "ğŸš²", "ğŸ›µ", "ğŸš—", "ğŸšŒ", "ğŸš…", "ğŸš¢", "âœˆï¸", "ğŸš€", "ğŸ›¸"]
            },
            D: {
                name: "ã‚¢ã‚¤ãƒ‰ãƒ«",
                chars: ["ğŸµ", "ğŸ©°", "ğŸ€", "ğŸ’„", "ğŸ‘—", "ğŸ¤", "ğŸ¸", "ğŸ¹", "ğŸ’ƒ", "ğŸ“¸", "ğŸ‘¸"]
            },
            E: {
                name: "å’Œé¢¨ãƒ»å¿è€…",
                chars: ["ğŸµ", "ğŸ™", "ğŸ¥‹", "ğŸ“œ", "ğŸ—¡ï¸", "ğŸ¥·", "ğŸ¯", "ğŸ‘º", "é¬¼", "ğŸŒ", "ğŸŒ¸"]
            }
        };

        const STORAGE_KEY = 'kanjiMasterProgress_v5';
        
        function getProgress() {
            const defaultData = {
                visitedGrades: {},
                lastLoginDate: "",
                dailyCount: 0,
                currentCourse: "A",
                xp: { A: 0, B: 0, C: 0, D: 0, E: 0 }
            };
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                return data ? { ...defaultData, ...JSON.parse(data) } : defaultData;
            } catch (e) {
                return defaultData;
            }
        }
        
        function saveProgress(progress) {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
            } catch (e) {
                console.error('ä¿å­˜ã‚¨ãƒ©ãƒ¼:', e);
            }
        }

        function showXPGainEffect(x, y, amount) {
            const effect = document.createElement('div');
            effect.className = 'xp-gain-effect';
            effect.textContent = `+${amount} XP`;
            effect.style.left = (x - 25) + 'px';
            effect.style.top = y + 'px';
            document.body.appendChild(effect);
            setTimeout(() => effect.remove(), 1200);
        }

        function showLevelUpPopup(newLevel, char) {
            const popup = document.getElementById('levelup-popup');
            document.getElementById('levelup-emoji').textContent = char;
            document.getElementById('levelup-char').textContent = `Lv.${newLevel} ã«é€²åŒ–ï¼`;
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 2500);
        }

        function updateXP() {
            let progress = getProgress();
            const today = new Date().toDateString();

            if (progress.lastLoginDate !== today) {
                progress.lastLoginDate = today;
                progress.dailyCount = 0;
            }

            if (progress.dailyCount < MAX_DAILY_XP) {
                progress.dailyCount++;
                const course = progress.currentCourse;
                const oldXP = progress.xp[course];
                
                if (oldXP < MAX_LEVEL) {
                    progress.xp[course]++;
                    const newXP = progress.xp[course];
                    
                    const oldStage = Math.floor(oldXP / EVOLUTION_STEP);
                    const newStage = Math.floor(newXP / EVOLUTION_STEP);
                    if (newStage > oldStage) {
                        const newChar = COURSES[course].chars[newStage];
                        showLevelUpPopup(newXP, newChar);
                    }
                    
                    const barContainer = document.getElementById('xp-bar-container');
                    const rect = barContainer.getBoundingClientRect();
                    showXPGainEffect(rect.left + 100, rect.top + 50, 1);
                }
            }
            
            saveProgress(progress);
            renderTopBar();
        }

        function renderTopBar() {
            const progress = getProgress();
            const courseID = progress.currentCourse;
            const currentXP = progress.xp[courseID];
            
            const stageIndex = Math.min(Math.floor(currentXP / EVOLUTION_STEP), 10);
            const char = COURSES[courseID].chars[stageIndex];

            const nextEvo = (stageIndex + 1) * EVOLUTION_STEP;
            const remaining = (currentXP >= MAX_LEVEL) ? 0 : (nextEvo - currentXP);
            
            let percent;
            if (currentXP >= MAX_LEVEL) {
                percent = 100;
            } else {
                const currentStageStart = stageIndex * EVOLUTION_STEP;
                percent = ((currentXP - currentStageStart) / EVOLUTION_STEP) * 100;
            }

            document.getElementById('current-char').textContent = char;
            document.getElementById('current-lvl').textContent = currentXP;
            const fillEl = document.getElementById('xp-fill');
            fillEl.style.width = percent + "%";
            
            if (currentXP >= MAX_LEVEL) {
                 document.getElementById('next-xp').textContent = "MAX";
                 fillEl.style.background = "linear-gradient(90deg, #FFD54F, #FFCA28)";
            } else {
                 document.getElementById('next-xp').textContent = remaining;
                 fillEl.style.background = "linear-gradient(90deg, #4FC3F7, #29B6F6)";
            }
        }
        
        function openCourseModal() {
            const modal = document.getElementById('course-modal');
            const listContainer = document.getElementById('course-list');
            const progress = getProgress();
            const currentCourse = progress.currentCourse;

            listContainer.innerHTML = '';

            for (const [key, data] of Object.entries(COURSES)) {
                const isActive = (key === currentCourse);
                const xp = progress.xp[key] || 0;
                const stageIndex = Math.min(Math.floor(xp / EVOLUTION_STEP), 10);
                const charIcon = data.chars[stageIndex];

                const div = document.createElement('div');
                div.className = `course-option ${isActive ? 'active' : ''}`;
                div.onclick = () => selectCourse(key);

                div.innerHTML = `
                    <div class="co-icon">${charIcon}</div>
                    <div class="co-name">
                        ${data.name}
                        <div class="co-level" style="font-weight:normal; font-size:0.8rem; margin-top:2px;">
                            Lv.${xp}
                        </div>
                    </div>
                    <div class="co-status">${isActive ? 'é¸æŠä¸­ âœ…' : 'ãã‚Šã‹ãˆã‚‹'}</div>
                `;
                listContainer.appendChild(div);
            }
            modal.style.display = 'flex';
        }

        function selectCourse(courseKey) {
            let progress = getProgress();
            if (progress.currentCourse !== courseKey) {
                progress.currentCourse = courseKey;
                saveProgress(progress);
                renderTopBar();
                showXPGainEffect(window.innerWidth / 2, window.innerHeight / 2, "ã‚³ãƒ¼ã‚¹å¤‰æ›´!");
            }
            document.getElementById('course-modal').style.display = 'none';
        }

        function closeCourseModal(e) {
            if (e.target.id === 'course-modal') {
                e.target.style.display = 'none';
            }
        }

        function showResetConfirm() {
            document.getElementById('reset-confirm-overlay').style.display = 'flex';
        }

        function cancelReset() {
            document.getElementById('reset-confirm-overlay').style.display = 'none';
        }

        function confirmReset() {
            try {
                localStorage.clear();
                document.getElementById('reset-confirm-overlay').style.display = 'none';
                window.location.reload();
            } catch (e) {
                console.error('ãƒªã‚»ãƒƒãƒˆã‚¨ãƒ©ãƒ¼:', e);
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const resetOverlay = document.getElementById('reset-confirm-overlay');
                const courseModal = document.getElementById('course-modal');
                if (resetOverlay.style.display === 'flex') cancelReset();
                if (courseModal.style.display === 'flex') courseModal.style.display = 'none';
            }
        });

        // --- ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã¨çµ±åˆã®è¦ (Launch Logic) ---
        const rawData = `
        1|ä¸€:ã„ã¡,ã„ã¤,ã²ã¨|å³:ã†,ã‚†ã†,ã¿ã|é›¨:ã†,ã‚ã‚,ã‚ã¾|å††:ãˆã‚“,ã¾ã‚‹|ç‹:ãŠã†|éŸ³:ãŠã‚“,ã„ã‚“,ãŠã¨,ã­|ä¸‹:ã‹,ã’,ã—ãŸ,ã—ã‚‚,ã‚‚ã¨,ã•|ç«:ã‹,ã²,ã»|èŠ±:ã‹,ã¯ãª|è²:ã‹ã„|å­¦:ãŒã,ã¾ãª|æ°—:ã,ã‘|ä¹:ãã‚…ã†,ã,ã“ã“ã®|ä¼‘:ãã‚…ã†,ã‚„ã™|ç‰:ãã‚‡ã,ãŸã¾|é‡‘:ãã‚“,ã“ã‚“,ã‹ã­,ã‹ãª|ç©º:ãã†,ãã‚‰,ã‚,ã‹ã‚‰,ã™|æœˆ:ã’ã¤,ãŒã¤,ã¤ã|çŠ¬:ã‘ã‚“,ã„ã¬|è¦‹:ã‘ã‚“,ã¿|äº”:ã”,ã„ã¤|å£:ã“ã†,ã,ãã¡|æ ¡:ã“ã†|å·¦:ã•,ã²ã ã‚Š|ä¸‰:ã•ã‚“,ã¿|å±±:ã•ã‚“,ã‚„ã¾|å­:ã—,ã™,ã“,ã­|å››:ã—,ã‚ˆ,ã‚ˆã‚“,ã‚ˆã£|ç³¸:ã—,ã„ã¨|å­—:ã˜,ã‚ã–|è€³:ã˜,ã¿ã¿|ä¸ƒ:ã—ã¡,ãªãª,ãªã®|è»Š:ã—ã‚ƒ,ãã‚‹ã¾|æ‰‹:ã—ã‚…,ãš,ã¦,ãŸ|å:ã˜ã‚…ã†,ã˜ã£,ã¨ãŠ,ã¨|å‡º:ã—ã‚…ã¤,ã™ã„,ã ,ã§|å¥³:ã˜ã‚‡,ã«ã‚‡,ã«ã‚‡ã†,ãŠã‚“ãª,ã‚|å°:ã—ã‚‡ã†,ã¡ã„,ã“,ãŠ|ä¸Š:ã˜ã‚‡ã†,ã—ã‚‡ã†,ã†ãˆ,ã†ã‚,ã‹ã¿,ã‚,ã®ã¼|æ£®:ã—ã‚“,ã‚‚ã‚Š|äºº:ã˜ã‚“,ã«ã‚“,ã²ã¨|æ°´:ã™ã„,ã¿ãš|æ­£:ã›ã„,ã—ã‚‡ã†,ãŸã ,ã¾ã•|ç”Ÿ:ã›ã„,ã—ã‚‡ã†,ã„,ã†,ãŠ,ã¯,ã,ãªã¾|é’:ã›ã„,ã—ã‚‡ã†,ã‚ãŠ|å¤•:ã›ã,ã‚†ã†|çŸ³:ã›ã,ã—ã‚ƒã,ã“ã,ã„ã—|èµ¤:ã›ã,ã—ã‚ƒã,ã‚ã‹|åƒ:ã›ã‚“,ã¡|å·:ã›ã‚“,ã‹ã‚|å…ˆ:ã›ã‚“,ã•ã,ã¾|æ—©:ãã†,ã•ã£,ã¯ã‚„|è‰:ãã†,ãã•|è¶³:ãã,ã‚ã—,ãŸ|æ‘:ãã‚“,ã‚€ã‚‰|å¤§:ã ã„,ãŸã„,ãŠãŠ|ç”·:ã ã‚“,ãªã‚“,ãŠã¨ã“|ç«¹:ã¡ã,ãŸã‘|ä¸­:ã¡ã‚…ã†,ãªã‹|è™«:ã¡ã‚…ã†,ã‚€ã—|ç”º:ã¡ã‚‡ã†,ã¾ã¡|å¤©:ã¦ã‚“,ã‚ã‚,ã‚ã¾|ç”°:ã§ã‚“,ãŸ|åœŸ:ã©,ã¨,ã¤ã¡|äºŒ:ã«,ãµãŸ|æ—¥:ã«ã¡,ã˜ã¤,ã²,ã‹|å…¥:ã«ã‚…ã†,ã¯ã„,ã„|å¹´:ã­ã‚“,ã¨ã—|ç™½:ã¯ã,ã³ã‚ƒã,ã—ã‚,ã—ã‚‰|å…«:ã¯ã¡,ã‚„,ã‚„ã£,ã‚ˆã†|ç™¾:ã²ã‚ƒã,ã‚‚ã‚‚|æ–‡:ã¶ã‚“,ã‚‚ã‚“,ãµã¿|æœ¨:ã¼ã,ã‚‚ã,ã,ã“|æœ¬:ã»ã‚“,ã‚‚ã¨|å:ã‚ã„,ã¿ã‚‡ã†,ãª|ç›®:ã‚‚ã,ã¼ã,ã‚,ã¾|ç«‹:ã‚Šã¤,ã‚Šã‚…ã†,ãŸ,ã |åŠ›:ã‚Šã‚‡ã,ã‚Šã,ã¡ã‹ã‚‰|æ—:ã‚Šã‚“,ã¯ã‚„ã—|å…­:ã‚ã,ã‚€,ã‚€ã£
ã€€ã€€ã€€  2|å¼•:ã„ã‚“,ã²|ç¾½:ã†,ã¯,ã¯ã­|é›²:ã†ã‚“,ãã‚‚|åœ’:ãˆã‚“,ãã®|é :ãˆã‚“,ãŠã‚“,ã¨ãŠ|ä½•:ã‹,ãªã«,ãªã‚“|ç§‘:ã‹|å¤:ã‹,ã’,ãªã¤|å®¶:ã‹,ã‘,ã„ãˆ,ã‚„|æ­Œ:ã‹,ã†ãŸ|ç”»:ãŒ,ã‹ã|å›:ã‹ã„,ãˆ,ã¾ã‚|ä¼š:ã‹ã„,ãˆ,ã‚|æµ·:ã‹ã„,ã†ã¿|çµµ:ã‹ã„,ãˆ|å¤–:ãŒã„,ã’,ãã¨,ã»ã‹,ã¯ãš|è§’:ã‹ã,ã‹ã©,ã¤ã®|æ¥½:ãŒã,ã‚‰ã,ãŸã®|æ´»:ã‹ã¤|é–“:ã‹ã‚“,ã‘ã‚“,ã‚ã„ã ,ã¾|ä¸¸:ãŒã‚“,ã¾ã‚‹|å²©:ãŒã‚“,ã„ã‚|é¡”:ãŒã‚“,ã‹ãŠ|æ±½:ã|è¨˜:ã,ã—ã‚‹|å¸°:ã,ã‹ãˆ|å¼“:ãã‚…ã†,ã‚†ã¿|ç‰›:ãã‚…ã†,ã†ã—|é­š:ãã‚‡,ã†ãŠ,ã•ã‹ãª|äº¬:ãã‚‡ã†,ã‘ã„,ãã‚“|å¼·:ãã‚‡ã†,ã”ã†,ã¤ã‚ˆ,ã—|æ•™:ãã‚‡ã†,ãŠã—,ãŠã|è¿‘:ãã‚“,ã¡ã‹|å…„:ã‘ã„,ãã‚‡ã†,ã‚ã«|å½¢:ã‘ã„,ãã‚‡ã†,ã‹ãŸ,ã‹ãŸã¡|è¨ˆ:ã‘ã„,ã¯ã‹|å…ƒ:ã’ã‚“,ãŒã‚“,ã‚‚ã¨|è¨€:ã’ã‚“,ã”ã‚“,ã„,ã“ã¨|åŸ:ã’ã‚“,ã¯ã‚‰|æˆ¸:ã“,ã¨|å¤:ã“,ãµã‚‹|åˆ:ã”|å¾Œ:ã”,ã“ã†,ã®ã¡,ã†ã—,ã‚ã¨,ãŠã|èª:ã”,ã‹ãŸ|å·¥:ã“ã†,ã|å…¬:ã“ã†,ãŠãŠã‚„ã‘|åºƒ:ã“ã†,ã²ã‚|äº¤:ã“ã†,ã¾ã˜,ã¾,ã‹|å…‰:ã“ã†,ã²ã‹ã‚Š,ã²ã‹|è€ƒ:ã“ã†,ã‹ã‚“ãŒ|è¡Œ:ã“ã†,ãã‚‡ã†,ã‚ã‚“,ã„,ã‚†,ãŠã“ãª|é«˜:ã“ã†,ãŸã‹|é»„:ã“ã†,ãŠã†,ã,ã“|åˆ:ã”ã†,ãŒã£,ã‹ã£,ã‚|è°·:ã“ã,ãŸã«|å›½:ã“ã,ãã«|é»’:ã“ã,ãã‚|ä»Š:ã“ã‚“,ãã‚“,ã„ã¾|æ‰:ã•ã„|ç´°:ã•ã„,ã»ã,ã“ã¾|ä½œ:ã•ã,ã•,ã¤ã|ç®—:ã•ã‚“|æ­¢:ã—,ã¨,ã‚„|å¸‚:ã—,ã„ã¡|çŸ¢:ã—,ã‚„|å§‰:ã—,ã‚ã­|æ€:ã—,ãŠã‚‚|ç´™:ã—,ã‹ã¿|å¯º:ã˜,ã¦ã‚‰|è‡ª:ã˜,ã—,ã¿ãšã‹|æ™‚:ã˜,ã¨ã|å®¤:ã—ã¤,ã‚€ã‚|ç¤¾:ã—ã‚ƒ,ã‚„ã—ã‚|å¼±:ã˜ã‚ƒã,ã‚ˆã‚|é¦–:ã—ã‚…,ãã³|ç§‹:ã—ã‚…ã†,ã‚ã|é€±:ã—ã‚…ã†|æ˜¥:ã—ã‚…ã‚“,ã¯ã‚‹|æ›¸:ã—ã‚‡,ã‹|å°‘:ã—ã‚‡ã†,ã™ã,ã™ã“|å ´:ã˜ã‚‡ã†,ã°|è‰²:ã—ã‚‡ã,ã—ã,ã„ã‚|é£Ÿ:ã—ã‚‡ã,ã˜ã,ãŸ,ã|å¿ƒ:ã—ã‚“,ã“ã“ã‚|æ–°:ã—ã‚“,ã‚ãŸã‚‰,ã‚ã‚‰,ã«ã„|è¦ª:ã—ã‚“,ãŠã‚„,ã—ãŸ|å›³:ãš,ã¨,ã¯ã‹|æ•°:ã™ã†,ã™,ã‹ãš,ã‹ã|è¥¿:ã›ã„,ã•ã„,ã«ã—|å£°:ã›ã„,ã—ã‚‡ã†,ã“ãˆ,ã“ã‚|æ˜Ÿ:ã›ã„,ã—ã‚‡ã†,ã»ã—|æ™´:ã›ã„,ã¯|åˆ‡:ã›ã¤,ã•ã„,ã|é›ª:ã›ã¤,ã‚†ã|èˆ¹:ã›ã‚“,ãµã­,ãµãª|ç·š:ã›ã‚“|å‰:ãœã‚“,ã¾ãˆ|çµ„:ã,ãã¿|èµ°:ãã†,ã¯ã—|å¤š:ãŸ,ãŠãŠ|å¤ª:ãŸã„,ãŸ,ãµã¨|ä½“:ãŸã„,ã¦ã„,ã‹ã‚‰ã |å°:ã ã„,ãŸã„|åœ°:ã¡,ã˜|æ± :ã¡,ã„ã‘|çŸ¥:ã¡,ã—|èŒ¶:ã¡ã‚ƒ,ã•|æ˜¼:ã¡ã‚…ã†,ã²ã‚‹|é•·:ã¡ã‚‡ã†,ãªãŒ|é³¥:ã¡ã‚‡ã†,ã¨ã‚Š|æœ:ã¡ã‚‡ã†,ã‚ã•|ç›´:ã¡ã‚‡ã,ã˜ã,ãªãŠ,ãŸã |é€š:ã¤ã†,ã¨ãŠ,ã‹ã‚ˆ|å¼Ÿ:ã¦ã„,ã ã„,ã§,ãŠã¨ã†ã¨|åº—:ã¦ã‚“,ã¿ã›|ç‚¹:ã¦ã‚“|é›»:ã§ã‚“|åˆ€:ã¨ã†,ã‹ãŸãª|å†¬:ã¨ã†,ãµã‚†|å½“:ã¨ã†,ã‚|æ±:ã¨ã†,ã²ãŒã—|ç­”:ã¨ã†,ã“ãŸ|é ­:ã¨ã†,ãš,ãƒˆ,ã‚ãŸã¾,ã‹ã—ã‚‰|åŒ:ã©ã†,ãŠãª|é“:ã©ã†,ã¨ã†,ã¿ã¡|èª­:ã©ã,ã¨ã,ã¨ã†,ã‚ˆ|å†…:ãªã„,ã ã„,ã†ã¡|å—:ãªã‚“,ãª,ã¿ãªã¿|è‚‰:ã«ã|é¦¬:ã°,ã†ã¾,ã¾|å£²:ã°ã„,ã†|è²·:ã°ã„,ã‹|éº¦:ã°ã,ã‚€ã|åŠ:ã¯ã‚“,ãªã‹|ç•ª:ã°ã‚“|çˆ¶:ãµ,ã¡ã¡|é¢¨:ãµã†,ãµ,ã‹ãœ,ã‹ã–|åˆ†:ã¶ã‚“,ãµã‚“,ã¶,ã‚|è:ã¶ã‚“,ã‚‚ã‚“,ã|ç±³:ã¹ã„,ã¾ã„,ã“ã‚|æ­©:ã»,ã¶,ãµ,ã‚ã‚‹,ã‚ã‚†|æ¯:ã¼,ã¯ã¯|æ–¹:ã»ã†,ã‹ãŸ|åŒ—:ã»ã,ããŸ|å¦¹:ã¾ã„,ã„ã‚‚ã†ã¨|æ¯:ã¾ã„|ä¸‡:ã¾ã‚“,ã°ã‚“|æ˜:ã‚ã„,ã¿ã‚‡ã†,ã‚,ã‚ã‹,ã‚ã|é³´:ã‚ã„,ãª|æ¯›:ã‚‚ã†,ã‘|é–€:ã‚‚ã‚“,ã‹ã©|å¤œ:ã‚„,ã‚ˆ,ã‚ˆã‚‹|é‡:ã‚„,ã®|å‹:ã‚†ã†,ã¨ã‚‚|ç”¨:ã‚ˆã†,ã‚‚ã¡|æ›œ:ã‚ˆã†|æ¥:ã‚‰ã„,ã,ããŸ,ã“|é‡Œ:ã‚Š,ã•ã¨|ç†:ã‚Š|è©±:ã‚,ã¯ãªã—,ã¯ãª
       3|æ‚ª:ã‚ã,ãŠ,ã‚ã‚‹|å®‰:ã‚ã‚“,ã‚„ã™|æš—:ã‚ã‚“,ãã‚‰|åŒ»:ã„|å§”:ã„,ã‚†ã |æ„:ã„|è‚²:ã„ã,ãã |å“¡:ã„ã‚“|é™¢:ã„ã‚“|é£²:ã„ã‚“,ã®|é‹:ã†ã‚“,ã¯ã“|æ³³:ãˆã„,ãŠã‚ˆ|é§…:ãˆã|å¤®:ãŠã†|æ¨ª:ãŠã†,ã‚ˆã“|å±‹:ãŠã,ã‚„|æ¸©:ãŠã‚“,ã‚ãŸãŸ|åŒ–:ã‹,ã‘,ã°|è·:ã‹,ã«|ç•Œ:ã‹ã„|é–‹:ã‹ã„,ã²ã‚‰,ã‚|éš:ã‹ã„|å¯’:ã‹ã‚“,ã•ã‚€|æ„Ÿ:ã‹ã‚“|æ¼¢:ã‹ã‚“|é¤¨:ã‹ã‚“,ã‚„ã‹ãŸ|å²¸:ãŒã‚“,ãã—|èµ·:ã,ãŠ|æœŸ:ã|å®¢:ãã‚ƒã,ã‹ã|ç©¶:ãã‚…ã†,ãã‚|æ€¥:ãã‚…ã†,ã„ã|ç´š:ãã‚…ã†|å®®:ãã‚…ã†,ãã†,ã,ã¿ã‚„|çƒ:ãã‚…ã†,ãŸã¾|å»:ãã‚‡,ã“,ã•|æ©‹:ãã‚‡ã†,ã¯ã—|æ¥­:ãã‚‡ã†,ã”ã†,ã‚ã–|æ›²:ãã‚‡ã,ã¾|å±€:ãã‚‡ã|éŠ€:ãã‚“|åŒº:ã|è‹¦:ã,ãã‚‹,ã«ãŒ|å…·:ã|å›:ãã‚“,ãã¿|ä¿‚:ã‘ã„,ã‹ã‹,ã‹ã‹ã‚Š|è»½:ã‘ã„,ã‹ã‚‹|è¡€:ã‘ã¤,ã¡|æ±º:ã‘ã¤,ã|ç ”:ã‘ã‚“,ã¨|çœŒ:ã‘ã‚“|åº«:ã“,ã|æ¹–:ã“,ã¿ãšã†ã¿|å‘:ã“ã†,ã‚€|å¹¸:ã“ã†,ã•ã„ã‚,ã•ã¡,ã—ã‚ã‚|æ¸¯:ã“ã†,ã¿ãªã¨|å·:ã”ã†|æ ¹:ã“ã‚“,ã­|ç¥­:ã•ã„,ã¾ã¤|çš¿:ã•ã‚‰|ä»•:ã—,ã˜,ã¤ã‹|æ­»:ã—|ä½¿:ã—,ã¤ã‹|å§‹:ã—,ã¯ã˜|æŒ‡:ã—,ã‚†ã³,ã•|æ­¯:ã—,ã¯|è©©:ã—|æ¬¡:ã˜,ã—,ã¤ã|äº‹:ã˜,ãš,ã“ã¨|æŒ:ã˜,ã‚‚|å¼:ã—ã|å®Ÿ:ã˜ã¤,ã¿,ã¿ã®|å†™:ã—ã‚ƒ,ã†ã¤|è€…:ã—ã‚ƒ,ã‚‚ã®|ä¸»:ã—ã‚…,ã™,ã¬ã—,ãŠã‚‚|å®ˆ:ã—ã‚…,ã™,ã¾ã‚‚,ã‚‚ã‚Š|å–:ã—ã‚…,ã¨|é…’:ã—ã‚…,ã•ã‘,ã•ã‹|å—:ã˜ã‚…,ã†|å·:ã—ã‚…ã†,ã™|æ‹¾:ã—ã‚…ã†,ã˜ã‚…ã†,ã²ã‚|çµ‚:ã—ã‚…ã†,ãŠ|ç¿’:ã—ã‚…ã†,ãªã‚‰|é›†:ã—ã‚…ã†,ã‚ã¤|ä½:ã˜ã‚…ã†,ã™|é‡:ã˜ã‚…ã†,ã¡ã‚‡ã†,ãˆ,ãŠã‚‚,ã‹ã•|å®¿:ã—ã‚…ã,ã‚„ã©|æ‰€:ã—ã‚‡,ã¨ã“ã‚|æš‘:ã—ã‚‡,ã‚ã¤|åŠ©:ã˜ã‚‡,ãŸã™,ã™ã‘|æ˜­:ã—ã‚‡ã†|æ¶ˆ:ã—ã‚‡ã†,ã,ã‘|å•†:ã—ã‚‡ã†,ã‚ããª|ç« :ã—ã‚‡ã†|å‹:ã—ã‚‡ã†,ã‹,ã¾ã•|ä¹—:ã˜ã‚‡ã†,ã®|æ¤:ã—ã‚‡ã,ã†|ç”³:ã—ã‚“,ã‚‚ã†|èº«:ã—ã‚“,ã¿|ç¥:ã—ã‚“,ã˜ã‚“,ã‹ã¿,ã‹ã‚“|çœŸ:ã—ã‚“,ã¾|æ·±:ã—ã‚“,ãµã‹|é€²:ã—ã‚“,ã™ã™|ä¸–:ã›ã„,ã›,ã‚ˆ|æ•´:ã›ã„,ã¨ã¨ã®|æ˜”:ã›ã,ã—ã‚ƒã,ã‚€ã‹ã—|å…¨:ãœã‚“,ã¾ã£ãŸ,ã™ã¹|ç›¸:ãã†,ã—ã‚‡ã†,ã‚ã„|é€:ãã†,ãŠã|æƒ³:ãã†,ã|æ¯:ãã,ã„ã|é€Ÿ:ãã,ã¯ã‚„,ã™ã¿|æ—:ãã|ä»–:ãŸ,ã»ã‹|æ‰“:ã ,ã†|å¯¾:ãŸã„,ã¤ã„|å¾…:ãŸã„,ã¾|ä»£:ã ã„,ãŸã„,ã‹,ã‚ˆ,ã—ã‚|ç¬¬:ã ã„|é¡Œ:ã ã„|ç‚­:ãŸã‚“,ã™ã¿|çŸ­:ãŸã‚“,ã¿ã˜ã‹|è«‡:ã ã‚“|ç€:ã¡ã‚ƒã,ã˜ã‚ƒã,ã,ã¤|æ³¨:ã¡ã‚…ã†,ãã|æŸ±:ã¡ã‚…ã†,ã¯ã—ã‚‰|ä¸:ã¡ã‚‡ã†,ã¦ã„|å¸³:ã¡ã‚‡ã†|èª¿:ã¡ã‚‡ã†,ã—ã‚‰,ã¨ã¨ã®|è¿½:ã¤ã„,ãŠ|å®š:ã¦ã„,ã˜ã‚‡ã†,ã•ã |åº­:ã¦ã„,ã«ã‚|ç¬›:ã¦ã,ãµãˆ|é‰„:ã¦ã¤|è»¢:ã¦ã‚“,ã“ã‚|éƒ½:ã¨,ã¤,ã¿ã‚„ã“|åº¦:ã©,ã¨,ãŸã,ãŸã³|æŠ•:ã¨ã†,ãª|è±†:ã¨ã†,ãš,ã¾ã‚|å³¶:ã¨ã†,ã—ã¾|æ¹¯:ã¨ã†,ã‚†|ç™»:ã¨ã†,ã¨,ã®ã¼|ç­‰:ã¨ã†,ã²ã¨,ãªã©|å‹•:ã©ã†,ã†ã”|ç«¥:ã©ã†,ã‚ã‚‰ã¹|è¾²:ã®ã†|æ³¢:ã¯,ãªã¿|é…:ã¯ã„,ãã°|å€:ã°ã„|ç®±:ã¯ã“|ç•‘:ã¯ãŸ,ã¯ãŸã‘|ç™º:ã¯ã¤,ã»ã¤|å:ã¯ã‚“,ã»ã‚“,ãŸã‚“,ã|å‚:ã¯ã‚“,ã•ã‹|æ¿:ã¯ã‚“,ã„ãŸ|çš®:ã²,ã‹ã‚|æ‚²:ã²,ã‹ãª|ç¾:ã³,ã†ã¤ã|é¼»:ã³,ã¯ãª|ç­†:ã²ã¤,ãµã§|æ°·:ã²ã‚‡ã†,ã“ãŠã‚Š,ã²|è¡¨:ã²ã‚‡ã†,ãŠã‚‚ã¦,ã‚ã‚‰ã‚|ç§’:ã³ã‚‡ã†|ç—…:ã³ã‚‡ã†,ã‚„ã¾ã„,ã‚„|å“:ã²ã‚“,ã—ãª|è² :ãµ,ã¾,ãŠ|éƒ¨:ã¶|æœ:ãµã|ç¦:ãµã|ç‰©:ã¶ã¤,ã‚‚ã¤,ã‚‚ã®|å¹³:ã¸ã„,ã³ã‚‡ã†,ãŸã„,ã²ã‚‰|è¿”:ã¸ã‚“,ã‹ãˆ|å‹‰:ã¹ã‚“|æ”¾:ã»ã†,ã¯ãª|å‘³:ã¿,ã‚ã˜|å‘½:ã‚ã„,ã¿ã‚‡ã†,ã„ã®ã¡|é¢:ã‚ã‚“,ãŠã‚‚,ãŠã‚‚ã¦,ã¤ã‚‰|å•:ã‚‚ã‚“,ã¨|å½¹:ã‚„ã,ãˆã|è–¬:ã‚„ã,ãã™ã‚Š|ç”±:ã‚†,ã‚ˆã—,ã‚†ã†|æ²¹:ã‚†,ã‚ã¶ã‚‰|æœ‰:ã‚†ã†,ã†,ã‚|éŠ:ã‚†ã†,ã‚†,ã‚ã|äºˆ:ã‚ˆ|ç¾Š:ã‚ˆã†,ã²ã¤ã˜|æ´‹:ã‚ˆã†|è‘‰:ã‚ˆã†,ã¯|é™½:ã‚ˆã†,ã²|æ§˜:ã‚ˆã†,ã•ã¾|è½:ã‚‰ã,ãŠ|æµ:ã‚Šã‚…ã†,ã‚‹,ãªãŒ|æ—…:ã‚Šã‚‡,ãŸã³|ä¸¡:ã‚Šã‚‡ã†|ç·‘:ã‚Šã‚‡ã,ã‚ã,ã¿ã©ã‚Š|ç¤¼:ã‚Œã„,ã‚‰ã„|åˆ—:ã‚Œã¤|ç·´:ã‚Œã‚“,ã­|è·¯:ã‚,ã˜,ã¿ã¡|å’Œ:ã‚,ã‚„ã‚,ãªã”
       4|æ„›:ã‚ã„,ã„ã¨|æ¡ˆ:ã‚ã‚“|ä»¥:ã„,ã‚‚ã£|è¡£:ã„,ã“ã‚ã‚‚|ä½:ã„,ãã‚‰ã„|å°:ã„ã‚“,ã—ã‚‹ã—|è‹±:ãˆã„|æ „:ãˆã„,ã•ã‹|å¡©:ãˆã‚“,ã—ãŠ|å„„:ãŠã|åŠ :ã‹,ãã‚|æœ:ã‹,ã¯|è²¨:ã‹|èª²:ã‹|èŠ½:ãŒ,ã‚|æ”¹:ã‹ã„,ã‚ã‚‰ãŸ|æ¢°:ã‹ã„|å®³:ãŒã„|è¡—:ãŒã„,ã‹ã„,ã¾ã¡|å„:ã‹ã,ãŠã®ãŠã®|è¦š:ã‹ã,ãŠã¼|å®Œ:ã‹ã‚“|å®˜:ã‹ã‚“|ç®¡:ã‹ã‚“,ãã |é–¢:ã‹ã‚“,ã›ã,ã‹ã‹|è¦³:ã‹ã‚“,ã¿|é¡˜:ãŒã‚“,ã­ãŒ|å¸Œ:ã|å­£:ã|æ——:ã,ã¯ãŸ|å™¨:ã,ã†ã¤ã‚|æ©Ÿ:ã,ã¯ãŸ|è­°:ã|æ±‚:ãã‚…ã†,ã‚‚ã¨|æ³£:ãã‚…ã†,ãª|çµ¦:ãã‚…ã†|æŒ™:ãã‚‡,ã‚|æ¼:ãã‚‡,ã‚Šã‚‡ã†|å…±:ãã‚‡ã†,ã¨ã‚‚|å”:ãã‚‡ã†|é¡:ãã‚‡ã†,ã‹ãŒã¿|ç«¶:ãã‚‡ã†,ã‘ã„,ãã|æ¥µ:ãã‚‡ã,ã”ã,ãã‚|è¨“:ãã‚“|è»:ãã‚“|éƒ¡:ãã‚“|å¾„:ã‘ã„|æ™¯:ã‘ã„|èŠ¸:ã’ã„|æ¬ :ã‘ã¤,ã‹|çµ:ã‘ã¤,ã‚€ã™|å»º:ã‘ã‚“,ã“ã‚“,ãŸ|å¥:ã‘ã‚“,ã™ã“|é¨“:ã‘ã‚“|å›º:ã“,ã‹ãŸ|åŠŸ:ã“ã†,ã|å¥½:ã“ã†,ã™|å€™:ã“ã†|åº·:ã“ã†|å·®:ã•|èœ:ã•ã„,ãª|æœ€:ã•ã„,ã‚‚ã£ã¨|æ:ã–ã„|æ˜¨:ã•ã|æœ­:ã•ã¤,ãµã |åˆ·:ã•ã¤,ã™|å¯Ÿ:ã•ã¤|å‚:ã•ã‚“,ã¾ã„|ç”£:ã•ã‚“,ã†|æ•£:ã•ã‚“,ã¡|æ®‹:ã–ã‚“,ã®ã“|æ°:ã—,ã†ã˜|å¸:ã—,ã¤ã‹ã•ã©|è©¦:ã—,ã“ã“ã‚|å…:ã˜,ã“|æ²»:ã˜,ã¡,ãŠã•|è¾:ã˜,ã‚„|å¤±:ã—ã¤,ã†ã—ãª|å€Ÿ:ã—ã‚ƒã,ã‹|ç¨®:ã—ã‚…,ãŸã­|å‘¨:ã—ã‚…ã†,ã¾ã‚|ç¥:ã—ã‚…ã†,ã—ã‚…ã,ã„ã‚|é †:ã˜ã‚…ã‚“|åˆ:ã—ã‚‡,ã¯ã˜,ã¯ã¤,ã†ã„|æ¾:ã—ã‚‡ã†,ã¾ã¤|ç¬‘:ã—ã‚‡ã†,ã‚ã‚‰|å”±:ã—ã‚‡ã†,ã¨ãª|ç„¼:ã—ã‚‡ã†,ã‚„|ç…§:ã—ã‚‡ã†,ã¦|è‡£:ã—ã‚“,ã˜ã‚“|ä¿¡:ã—ã‚“|æˆ:ã›ã„,ã˜ã‚‡ã†,ãª|çœ:ã›ã„,ã—ã‚‡ã†,ã‹ãˆã‚Š|æ¸…:ã›ã„,ã—ã‚‡ã†,ãã‚ˆ|é™:ã›ã„,ã˜ã‚‡ã†,ã—ãš|å¸­:ã›ã|ç©:ã›ã,ã¤|æŠ˜:ã›ã¤,ãŠ|ç¯€:ã›ã¤,ãµã—|èª¬:ã›ã¤,ã¨|æµ…:ã›ã‚“,ã‚ã•|æˆ¦:ã›ã‚“,ã„ãã•|é¸:ã›ã‚“,ãˆã‚‰|ç„¶:ãœã‚“|äº‰:ãã†,ã‚ã‚‰ã|å€‰:ãã†,ãã‚‰|å·£:ãã†,ã™|æŸ:ãã,ãŸã°|å´:ãã,ãŒã‚|ç¶š:ãã,ã¤ã¥|å’:ãã¤|å­«:ãã‚“,ã¾ã”|å¸¯:ãŸã„,ãŠã³|éšŠ:ãŸã„|é”:ãŸã¤,ãŸã¡|å˜:ãŸã‚“|ç½®:ã¡,ãŠ|ä»²:ã¡ã‚…ã†,ãªã‹|å…†:ã¡ã‚‡ã†,ãã–|ä½:ã¦ã„,ã²ã|åº•:ã¦ã„,ãã“|çš„:ã¦ã,ã¾ã¨|å…¸:ã¦ã‚“|ä¼:ã§ã‚“,ã¤ãŸ|å¾’:ã¨|åŠª:ã©,ã¤ã¨|ç¯:ã¨ã†,ã²|åƒ:ã©ã†,ã¯ãŸã‚‰|ç‰¹:ã¨ã|ç†±:ã­ã¤,ã‚ã¤|å¿µ:ã­ã‚“|æ•—:ã¯ã„,ã‚„ã¶|æ¢…:ã°ã„,ã†ã‚|åš:ã¯ã,ã°ã|é£¯:ã¯ã‚“,ã‚ã—|é£›:ã²,ã¨|å¿…:ã²ã¤,ã‹ãªã‚‰|ç¥¨:ã²ã‚‡ã†|æ¨™:ã²ã‚‡ã†,ã—ã‚‹ã¹|ä¸:ãµ,ã¶|å¤«:ãµ,ãµã†,ãŠã£ã¨|ä»˜:ãµ,ã¤|åºœ:ãµ|å‰¯:ãµã|å…µ:ã¸ã„,ã²ã‚‡ã†|åˆ¥:ã¹ã¤,ã‚ã‹|è¾º:ã¸ã‚“,ã‚ãŸ|å¤‰:ã¸ã‚“,ã‹|ä¾¿:ã¹ã‚“,ãŸã‚ˆã‚Š|åŒ…:ã»ã†,ã¤ã¤|æ³•:ã»ã†|æœ›:ã¼ã†,ã®ã|ç‰§:ã¼ã,ã¾ã|æœ«:ã¾ã¤,ã™ãˆ|æº€:ã¾ã‚“,ã¿|æœª:ã¿|æ°‘:ã¿ã‚“,ãŸã¿|ç„¡:ã‚€,ãª|ç´„:ã‚„ã|å‹‡:ã‚†ã†,ã„ã•|è¦:ã‚ˆã†,ã„|é¤Š:ã‚ˆã†,ã‚„ã—ãª|æµ´:ã‚ˆã,ã‚|åˆ©:ã‚Š,ã|é™¸:ã‚Šã|è‰¯:ã‚Šã‚‡ã†,ã‚ˆ|æ–™:ã‚Šã‚‡ã†|é‡:ã‚Šã‚‡ã†,ã¯ã‹|è¼ª:ã‚Šã‚“,ã‚|é¡:ã‚‹ã„|ä»¤:ã‚Œã„|å†·:ã‚Œã„,ã¤ã‚|ä¾‹:ã‚Œã„,ãŸã¨|é€£:ã‚Œã‚“,ã¤ã‚‰|è€:ã‚ã†,ãŠ|åŠ´:ã‚ã†|éŒ²:ã‚ã|è³€:ãŒ|ç¾¤:ãã‚“,ã‚€|å¾³:ã¨ã|å¯Œ:ãµ,ãµã†,ã¨,ã¨ã¿|åŸ:ã˜ã‚‡ã†,ã—ã‚,ã|èŒ¨:ã„ã°,ã„ã°ã‚‰|åª›:ãˆã‚“,ã²ã‚|å²¡:ã“ã†,ãŠã‹|æ½Ÿ:ã›ã,ã‹ãŸ,ãŒãŸ|å²:ã,ã|ç†Š:ãã¾|é¦™:ã“ã†,ã‹ãŠã‚Š|ä½:ã•|åŸ¼:ã•ã„,ã•ã|å´:ã,ã•ã|æ»‹:ã˜,ã—ã’|é¹¿:ã—ã‹,ã‹|ç¸„:ã˜ã‚‡ã†,ãªã‚|äº•:ã›ã„,ã—ã‚‡ã†,ã„|æ²–:ã¡ã‚…ã†,ãŠã|æ ƒ:ã¨ã¡|å¥ˆ:ãª|æ¢¨:ã‚Š,ãªã—|é˜ª:ã¯ã‚“,ã•ã‹|é˜œ:ãµ
       5|å›²:ã„,ã‹ã“|ç´€:ã|å–œ:ã,ã‚ˆã‚ã“|æ•‘:ãã‚…ã†,ã™ã|å‹:ã‘ã„,ã‹ãŸ|èˆª:ã“ã†|å‘Š:ã“ã,ã¤|æ®º:ã•ã¤,ã“ã‚|å£«:ã—|å²:ã—|è±¡:ã—ã‚‡ã†,ãã†|è³:ã—ã‚‡ã†|è²¯:ã¡ã‚‡|åœ:ã¦ã„|å ‚:ã©ã†|å¾—:ã¨ã,ãˆ|æ¯’:ã©ã|è²»:ã²,ã¤ã„|ç²‰:ãµã‚“,ã“,ã“ãª|è„ˆ:ã¿ã‚ƒã|æ­´:ã‚Œã|åœ§:ã‚ã¤|ç§»:ã„,ã†ã¤|å› :ã„ã‚“,ã‚ˆ|æ°¸:ãˆã„,ãªãŒ|å–¶:ãˆã„,ã„ã¨ãª|è¡›:ãˆã„|æ˜“:ãˆã,ã„,ã‚„ã•|ç›Š:ãˆã,ã‚„ã|æ¶²:ãˆã|æ¼”:ãˆã‚“|å¿œ:ãŠã†,ã“ãŸ|å¾€:ãŠã†|æ¡œ:ãŠã†,ã•ãã‚‰|å¯:ã‹|ä»®:ã‹,ã‘,ã‹ã‚Š|ä¾¡:ã‹,ã‚ãŸã„|æ²³:ã‹,ã‹ã‚|é:ã‹,ã™,ã‚ã‚„ã¾|è§£:ã‹ã„,ã’,ã¨|æ ¼:ã‹ã,ã“ã†|ç¢º:ã‹ã,ãŸã—|é¡:ãŒã,ã²ãŸã„|åˆŠ:ã‹ã‚“|å¹¹:ã‹ã‚“,ã¿ã|æ…£:ã‹ã‚“,ãª|çœ¼:ãŒã‚“,ã’ã‚“,ã¾ãªã“|åŸº:ã,ã‚‚ã¨|å¯„:ã,ã‚ˆ|è¦:ã|æŠ€:ã,ã‚ã–|ç¾©:ã|é€†:ãã‚ƒã,ã•ã‹|ä¹…:ãã‚…ã†,ã²ã•|æ—§:ãã‚…ã†|å±…:ãã‚‡,ã„|è¨±:ãã‚‡,ã‚†ã‚‹|å¢ƒ:ãã‚‡ã†,ã‘ã„,ã•ã‹ã„|å‡:ãã‚“|ç¦:ãã‚“|å¥:ã|çµŒ:ã‘ã„,ãã‚‡ã†,ã¸,ãŸ|æ½”:ã‘ã¤,ã„ã•ãã‚ˆ|ä»¶:ã‘ã‚“|é™º:ã‘ã‚“,ã‘ã‚|æ¤œ:ã‘ã‚“|é™:ã’ã‚“,ã‹ã|ç¾:ã’ã‚“,ã‚ã‚‰ã‚|æ¸›:ã’ã‚“,ã¸|æ•…:ã“,ã‚†ãˆ,ãµã‚‹|å€‹:ã“|è­·:ã”,ã¾ã‚‚|åŠ¹:ã“ã†,ã|åš:ã“ã†,ã‚ã¤|è€•:ã“ã†,ãŸãŒã‚„|é‰±:ã“ã†|æ§‹:ã“ã†,ã‹ã¾|èˆˆ:ã“ã†,ãã‚‡ã†,ãŠã“|è¬›:ã“ã†|æ··:ã“ã‚“,ã¾|æŸ»:ã•|å†:ã•ã„,ã•,ãµãŸãŸ|ç½:ã•ã„,ã‚ã–ã‚|å¦»:ã•ã„,ã¤ã¾|æ¡:ã•ã„,ã¨|éš›:ã•ã„,ãã‚|åœ¨:ã–ã„,ã‚|è²¡:ã–ã„,ã•ã„|ç½ª:ã–ã„,ã¤ã¿|é›‘:ã–ã¤,ãã†|é…¸:ã•ã‚“,ã™|è³›:ã•ã‚“|æ”¯:ã—,ã•ã•|å¿—:ã—,ã“ã“ã‚ã–ã—|æ:ã—,ãˆã |å¸«:ã—|è³‡:ã—|é£¼:ã—,ã‹|ç¤º:ã˜,ã—,ã—ã‚|ä¼¼:ã˜,ã«|è­˜:ã—ã|è³ª:ã—ã¤,ã—ã¡,ãŸã¡|èˆ:ã—ã‚ƒ|è¬:ã—ã‚ƒ,ã‚ã‚„ã¾|æˆ:ã˜ã‚…,ã•ãš|ä¿®:ã—ã‚…ã†,ã—ã‚…,ãŠã•|è¿°:ã˜ã‚…ã¤,ã®|è¡“:ã˜ã‚…ã¤,ã™ã¹|æº–:ã˜ã‚…ã‚“|åº:ã˜ã‚‡|æ‹›:ã—ã‚‡ã†,ã¾ã­|è¨¼:ã—ã‚‡ã†|æ¡:ã˜ã‚‡ã†|çŠ¶:ã˜ã‚‡ã†|å¸¸:ã˜ã‚‡ã†,ã¤ã­,ã¨ã“|æƒ…:ã˜ã‚‡ã†,ãªã•|ç¹”:ã—ã‚‡ã,ã—ã,ãŠ|è·:ã—ã‚‡ã|åˆ¶:ã›ã„|æ€§:ã›ã„,ã—ã‚‡ã†|æ”¿:ã›ã„,ã—ã‚‡ã†,ã¾ã¤ã‚Šã”ã¨|å‹¢:ã›ã„,ã„ããŠ|ç²¾:ã›ã„,ã—ã‚‡ã†|è£½:ã›ã„|ç¨:ãœã„|è²¬:ã›ã,ã›|ç¸¾:ã›ã|æ¥:ã›ã¤,ã¤|è¨­:ã›ã¤,ã‚‚ã†|çµ¶:ãœã¤,ãŸ|ç¥–:ã|ç´ :ã,ã™|ç·:ãã†|é€ :ãã†,ã¤ã|åƒ:ãã†|å¢—:ãã†,ã¾,ãµ|å‰‡:ãã|æ¸¬:ãã,ã¯ã‹|å±:ãã|ç‡:ãã¤,ã‚Šã¤,ã²ã|æ:ãã‚“,ãã“|è²¸:ãŸã„,ã‹|æ…‹:ãŸã„|å›£:ã ã‚“,ã¨ã‚“|æ–­:ã ã‚“,ã“ã¨ã‚,ãŸ|ç¯‰:ã¡ã,ããš|å¼µ:ã¡ã‚‡ã†,ã¯|æ:ã¦ã„,ã•|ç¨‹:ã¦ã„,ã»ã©|é©:ã¦ã|çµ±:ã¨ã†,ã™|éŠ…:ã©ã†|å°:ã©ã†,ã¿ã¡ã³|ç‹¬:ã©ã,ã²ã¨|ä»»:ã«ã‚“,ã¾ã‹|ç‡ƒ:ã­ã‚“,ã‚‚|èƒ½:ã®ã†|ç ´:ã¯,ã‚„ã¶|çŠ¯:ã¯ã‚“,ãŠã‹|åˆ¤:ã¯ã‚“,ã°ã‚“|ç‰ˆ:ã¯ã‚“|æ¯”:ã²,ãã‚‰|è‚¥:ã²,ã“|é:ã²|å‚™:ã³,ããª|è©•:ã²ã‚‡ã†|è²§:ã²ã‚“,ã³ã‚“,ã¾ãš|å¸ƒ:ãµ,ã¬ã®|å©¦:ãµ|æ­¦:ã¶,ã‚€|å¾©:ãµã|è¤‡:ãµã|ä»:ã¶ã¤,ã»ã¨ã‘|ç·¨:ã¸ã‚“,ã‚|å¼:ã¹ã‚“|ä¿:ã»,ãŸã‚‚|å¢“:ã¼,ã¯ã‹|å ±:ã»ã†,ã‚€ã|è±Š:ã»ã†,ã‚†ãŸ|é˜²:ã¼ã†,ãµã›|è²¿:ã¼ã†|æš´:ã¼ã†,ã‚ã°|å‹™:ã‚€,ã¤ã¨|å¤¢:ã‚€,ã‚†ã‚|è¿·:ã‚ã„,ã¾ã‚ˆ|ç¶¿:ã‚ã‚“,ã‚ãŸ|è¼¸:ã‚†|ä½™:ã‚ˆ,ã‚ã¾|å®¹:ã‚ˆã†|ç•¥:ã‚Šã‚ƒã|ç•™:ã‚Šã‚…ã†,ã‚‹,ã¨|é ˜:ã‚Šã‚‡ã†|å¿«:ã‹ã„,ã“ã“ã‚ã‚ˆ
       6|èƒƒ:ã„|è…¸:ã¡ã‚‡ã†|æ©:ãŠã‚“|åˆ¸:ã‘ã‚“|æ‰¿:ã—ã‚‡ã†,ã†ã‘ãŸã¾ã‚|èˆŒ:ãœã¤,ã—ãŸ|éŠ­:ã›ã‚“,ãœã«|é€€:ãŸã„,ã—ã‚Šã|æ•µ:ã¦ã,ã‹ãŸã|ä¿µ:ã²ã‚‡ã†,ãŸã‚ã‚‰|é :ã‚ˆ,ã‚ãš|ç•°:ã„,ã“ã¨|éº:ã„|åŸŸ:ã„ã|å®‡:ã†|æ˜ :ãˆã„,ã†ã¤,ã¯|å»¶:ãˆã‚“,ã®|æ²¿:ãˆã‚“,ã|æˆ‘:ãŒ,ã‚ã‚Œ,ã‚|ç°:ã‹ã„,ã¯ã„|æ‹¡:ã‹ã|é©:ã‹ã,ã‹ã‚|é–£:ã‹ã|å‰²:ã‹ã¤,ã‚|æ ª:ã‹ã¶|å¹²:ã‹ã‚“,ã»,ã²|å·»:ã‹ã‚“,ã¾|çœ‹:ã‹ã‚“|ç°¡:ã‹ã‚“|å±:ã,ã‚ã¶,ã‚ã‚„|æœº:ã,ã¤ããˆ|è²´:ã,ã¨ã†ã¨,ãŸã£ã¨|ç–‘:ã,ã†ãŸãŒ|å¸:ãã‚…ã†,ã™|ä¾›:ãã‚‡ã†,ã,ã¨ã‚‚,ããª|èƒ¸:ãã‚‡ã†,ã‚€ã­,ã‚€ãª|éƒ·:ãã‚‡ã†,ã”ã†|å‹¤:ãã‚“,ã”ã‚“,ã¤ã¨|ç­‹:ãã‚“,ã™ã˜|ç³»:ã‘ã„|æ•¬:ã‘ã„,ã†ã‚„ã¾|è­¦:ã‘ã„|åŠ‡:ã’ã|æ¿€:ã’ã,ã¯ã’|ç©´:ã‘ã¤,ã‚ãª|çµ¹:ã‘ã‚“,ãã¬|æ¨©:ã‘ã‚“,ã”ã‚“|æ†²:ã‘ã‚“|æº:ã’ã‚“,ã¿ãªã‚‚ã¨|å³:ã’ã‚“,ã”ã‚“,ãã³,ã„ã‹|å·±:ã“,ã,ãŠã®ã‚Œ|å‘¼:ã“,ã‚ˆ|èª¤:ã”,ã‚ã‚„ã¾|å:ã“ã†,ãã•ã|å­:ã“ã†|çš‡:ã“ã†,ãŠã†|ç´…:ã“ã†,ã¹ã«,ãã‚Œãªã„|é™:ã“ã†,ãŠ,ãµ|é‹¼:ã“ã†,ã¯ãŒã­|åˆ»:ã“ã,ãã–|ç©€:ã“ã|éª¨:ã“ã¤,ã»ã­|å›°:ã“ã‚“,ã“ã¾|ç ‚:ã•,ã—ã‚ƒ,ã™ãª|åº§:ã–,ã™ã‚|æ¸ˆ:ã•ã„,ã™|è£:ã•ã„,ã•ã°,ãŸ|ç­–:ã•ã|å†Š:ã•ã¤,ã•ã|èš•:ã•ã‚“,ã‹ã„ã“|è‡³:ã—,ã„ãŸ|ç§:ã—,ã‚ãŸãã—,ã‚ãŸã—|å§¿:ã—,ã™ãŒãŸ|è¦–:ã—|è©:ã—|èªŒ:ã—|ç£:ã˜|å°„:ã—ã‚ƒ,ã„|æ¨:ã—ã‚ƒ,ã™|å°º:ã—ã‚ƒã|è‹¥:ã˜ã‚ƒã,ã«ã‚ƒã,ã‚ã‹|æ¨¹:ã˜ã‚…,ã|å:ã—ã‚…ã†,ãŠã•|å®—:ã—ã‚…ã†,ãã†|å°±:ã—ã‚…ã†,ã˜ã‚…,ã¤|è¡†:ã—ã‚…ã†,ã—ã‚…|å¾“:ã˜ã‚…ã†,ã—ã‚‡ã†,ã˜ã‚…,ã—ãŸãŒ|ç¸¦:ã˜ã‚…ã†,ãŸã¦|ç¸®:ã—ã‚…ã,ã¡ã¢|ç†Ÿ:ã˜ã‚…ã,ã†|ç´”:ã˜ã‚…ã‚“|å‡¦:ã—ã‚‡|ç½²:ã—ã‚‡|è«¸:ã—ã‚‡,ã‚‚ã‚|é™¤:ã˜ã‚‡,ã˜,ã®ã|å°†:ã—ã‚‡ã†|å‚·:ã—ã‚‡ã†,ããš,ã„ãŸ|éšœ:ã—ã‚‡ã†,ã•ã‚|è’¸:ã˜ã‚‡ã†,ã‚€|é‡:ã—ã‚“,ã¯ã‚Š|ä»:ã˜ã‚“,ã«|å‚:ã™ã„,ãŸ|æ¨:ã™ã„,ãŠ|å¯¸:ã™ã‚“|ç››:ã›ã„,ã˜ã‚‡ã†,ã‚‚,ã•ã‹|è–:ã›ã„,ã—ã‚‡ã†|èª :ã›ã„|å®£:ã›ã‚“,ã®ãŸã¾|å°‚:ã›ã‚“,ã‚‚ã£ã±|æ³‰:ã›ã‚“,ã„ãšã¿|æ´—:ã›ã‚“,ã‚ã‚‰|æŸ“:ã›ã‚“,ã,ã—|å–„:ãœã‚“,ã‚ˆ|å¥:ãã†,ã‹ãª|çª“:ãã†,ã¾ã©|å‰µ:ãã†,ã¤ã|è£…:ãã†,ã—ã‚‡ã†,ã‚ˆããŠ|å±¤:ãã†|æ“:ãã†,ã¿ã•ãŠ,ã‚ã‚„ã¤|è”µ:ãã†,ãã‚‰|è‡“:ãã†|å­˜:ãã‚“,ãã‚“|å°Š:ãã‚“,ã¨ã†ã¨,ãŸã£ã¨|å®…:ãŸã|æ‹…:ãŸã‚“,ã‹ã¤,ã«ãª|æ¢:ãŸã‚“,ã•ãŒ,ã•ã|èª•:ãŸã‚“|æ®µ:ã ã‚“|æš–:ã ã‚“,ã‚ãŸãŸ|å€¤:ã¡,ã‚ãŸã„,ã­|å®™:ã¡ã‚…ã†|å¿ :ã¡ã‚…ã†|è‘—:ã¡ã‚‡,ã„ã¡ã˜ã‚‹,ã‚ã‚‰ã‚|åº:ã¡ã‚‡ã†|é ‚:ã¡ã‚‡ã†,ã„ãŸã ã|æ½®:ã¡ã‚‡ã†,ã—ãŠ|è³ƒ:ã¡ã‚“|ç—›:ã¤ã†,ã„ãŸ|å±•:ã¦ã‚“|è¨:ã¨ã†,ã†|å…š:ã¨ã†|ç³–:ã¨ã†|å±Š:ã¨ã©|é›£:ãªã‚“,ã‚€ãšã‹,ã‹ãŸ|ä¹³:ã«ã‚…ã†,ã¡ã¡,ã¡|èª:ã«ã‚“,ã¿ã¨|ç´:ã®ã†,ãŠã•|è„³:ã®ã†|æ´¾:ã¯|æ‹:ã¯ã„,ãŠãŒ|èƒŒ:ã¯ã„,ã›,ã›ã„,ãã‚€|è‚º:ã¯ã„|ä¿³:ã¯ã„|ç­:ã¯ã‚“|æ™©:ã°ã‚“|å¦:ã²,ã„ãª|æ‰¹:ã²|ç§˜:ã²,ã²ã‚|è…¹:ãµã,ã¯ã‚‰|å¥®:ãµã‚“,ãµã‚‹|ä¸¦:ã¸ã„,ãªã¿,ãªã‚‰|é™›:ã¸ã„|é–‰:ã¸ã„,ã¨,ã—|ç‰‡:ã¸ã‚“,ã‹ãŸ|è£œ:ã»,ãŠããª|æš®:ã¼,ã|å®:ã»ã†,ãŸã‹ã‚‰|è¨ª:ã»ã†,ãŠã¨ãš,ãŸãš|äº¡:ã¼ã†,ã‚‚ã†,ãª|å¿˜:ã¼ã†,ã‚ã™|æ£’:ã¼ã†|æš:ã¾ã„|å¹•:ã¾ã,ã°ã|å¯†:ã¿ã¤|ç›Ÿ:ã‚ã„|æ¨¡:ã‚‚,ã¼|è¨³:ã‚„ã,ã‚ã‘|éƒµ:ã‚†ã†|å„ª:ã‚†ã†,ã‚„ã•,ã™ã|å¹¼:ã‚ˆã†,ãŠã•ãª|æ¬²:ã‚ˆã,ã»ã£,ã»|ç¿Œ:ã‚ˆã|ä¹±:ã‚‰ã‚“,ã¿ã |åµ:ã‚‰ã‚“,ãŸã¾ã”|è¦§:ã‚‰ã‚“|è£:ã‚Š,ã†ã‚‰|å¾‹:ã‚Šã¤,ã‚Šã¡|è‡¨:ã‚Šã‚“,ã®ã|æœ—:ã‚ã†,ã»ãŒ|è«–:ã‚ã‚“|æ®:ã
       `;
        const searchDB = [];
        const gradeColors = { 1:"#FF8A65", 2:"#FFD54F", 3:"#4FC3F7", 4:"#81C784", 5:"#BA68C8", 6:"#7986CB" };

        rawData.trim().split('\n').forEach(line => {
            line = line.trim();
            if(!line) return;
            const parts = line.split('|');
            const grade = parseInt(parts[0]);
            
            for(let i=1; i<parts.length; i++) {
                const entry = parts[i].split(':');
                const char = entry[0];
                const readings = entry[1] ? entry[1].split(',') : [];
                
                searchDB.push({
                    char: char,
                    readings: readings,
                    grade: grade
                });
            }
        });

        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');

        // â˜…â˜…â˜… å¤‰æ›´ç‚¹: launchAppé–¢æ•° â˜…â˜…â˜…
        // æ—§: å¤–éƒ¨ã‚µã‚¤ãƒˆã‚’é–‹ã
        // æ–°: å†…éƒ¨ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã™ã‚‹
        function launchApp(grade) {
            // 1. ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
            currentGrade = grade;
            // æ¤œç´¢DBã‹ã‚‰è©²å½“å­¦å¹´ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã€ã‚¢ãƒ—ãƒªç”¨å½¢å¼ã«å¤‰æ›
            currentAppKanjiData = searchDB
                .filter(item => item.grade === grade)
                .map(item => ({
                    char: item.char,
                    reading: item.readings.join(' / ')
                }));

            // 2. ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('portal-view').style.display = 'none';
            document.getElementById('app-view').style.display = 'block';
            document.body.classList.add('app-mode'); // èƒŒæ™¯è‰²ãªã©ã‚’ã‚¢ãƒ—ãƒªç”¨ã«å¤‰æ›´

            // 3. ã‚¢ãƒ—ãƒªåˆæœŸåŒ–
            initAppForGrade(grade);
        }
        
        // ã‚¢ãƒ—ãƒªã‹ã‚‰æˆ»ã‚‹å‡¦ç†
        function exitApp() {
            document.getElementById('app-view').style.display = 'none';
            document.getElementById('portal-view').style.display = 'block'; // ã¾ãŸã¯ flex
            document.body.classList.remove('app-mode');
            
            // XPã®åæ˜ ï¼ˆã‚¢ãƒ—ãƒªå†…ã§XPãŒå¢—ãˆãŸå ´åˆï¼‰
            renderTopBar();
        }

        // æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯ (ãƒãƒ¼ã‚¿ãƒ«)
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.trim();
            searchResults.innerHTML = '';
            
            if (!query) {
                searchResults.style.display = 'none';
                return;
            }

            const queryLower = query.toLowerCase();
            const limitMatches = searchDB.filter(item => {
                if (item.char === query) return true;
                return item.readings.some(r => {
                    const rLower = r.toLowerCase();
                    return rLower.includes(queryLower);
                });
            }).slice(0, 20);

            if (limitMatches.length > 0) {
                limitMatches.forEach(m => {
                    const div = document.createElement('div');
                    div.className = 'result-card';
                    const color = gradeColors[m.grade];
                    const readingDisplay = m.readings.join(' / ');
                    
                    div.innerHTML = `
                        <div class="res-left">
                            <span class="res-char" style="color:${color}">${m.char}</span>
                            <div>
                                <div style="font-weight:bold; font-size:0.9rem;">${m.grade}å¹´ç”Ÿ</div>
                                <div class="res-reading">${readingDisplay}</div>
                            </div>
                        </div>
                        <span class="res-badge" style="background:${color}">é–‹ã</span>
                    `;
                    div.onclick = () => {
                        searchResults.style.display = 'none';
                        searchInput.value = '';
                        launchApp(m.grade);
                    };
                    searchResults.appendChild(div);
                });
                searchResults.style.display = 'block';
            } else {
                searchResults.innerHTML = '<div style="padding:15px; color:#999; text-align:center;">è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸğŸ˜¢</div>';
                searchResults.style.display = 'block';
            }
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-container')) {
                searchResults.style.display = 'none';
            }
        });
        
        // åˆæœŸåŒ– (ãƒãƒ¼ã‚¿ãƒ«)
        renderTopBar();


        // =========================================
        // 2. ã‚¢ãƒ—ãƒª (Grade App) Logic
        // =========================================
        
        // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° (App) ---
        let currentGrade = 0;
        let currentAppKanjiData = []; // launchAppã§ã‚»ãƒƒãƒˆã•ã‚Œã‚‹
        let progressPractice = {};
        let progressTest = {};
        let writer;
        let currentChar = null;
        let currentMode = 'practice';
        
        // åŠ¹æœéŸ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
        let audioContext;
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        function playSound(type) {
            try {
                initAudio();
                const now = audioContext.currentTime;
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);

                switch(type) {
                    case 'success':
                        osc.frequency.setValueAtTime(800, now);
                        osc.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
                        gain.gain.setValueAtTime(0.3, now);
                        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
                        osc.start(now); osc.stop(now + 0.15);
                        break;
                    case 'complete':
                        osc.frequency.setValueAtTime(1000, now);
                        osc.frequency.exponentialRampToValueAtTime(600, now + 0.05);
                        gain.gain.setValueAtTime(0.4, now);
                        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                        osc.start(now); osc.stop(now + 0.1);
                        break;
                    case 'click':
                        osc.frequency.setValueAtTime(600, now);
                        osc.frequency.exponentialRampToValueAtTime(400, now + 0.08);
                        gain.gain.setValueAtTime(0.2, now);
                        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.08);
                        osc.start(now); osc.stop(now + 0.08);
                        break;
                    case 'error':
                        osc.frequency.setValueAtTime(300, now);
                        osc.frequency.exponentialRampToValueAtTime(200, now + 0.15);
                        gain.gain.setValueAtTime(0.2, now);
                        gain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
                        osc.start(now); osc.stop(now + 0.15);
                        break;
                    case 'levelup':
                        [800, 1000, 1200].forEach((freq, i) => {
                            const o = audioContext.createOscillator();
                            const g = audioContext.createGain();
                            o.connect(g);
                            g.connect(audioContext.destination);
                            o.frequency.value = freq;
                            g.gain.setValueAtTime(0.3, now + i * 0.08);
                            g.gain.exponentialRampToValueAtTime(0.01, now + i * 0.08 + 0.1);
                            o.start(now + i * 0.08);
                            o.stop(now + i * 0.08 + 0.1);
                        });
                        break;
                }
            } catch(e) { console.log('éŸ³å£°ã‚¨ãƒ©ãƒ¼:', e); }
        }

        // ã‚¢ãƒ—ãƒªåˆæœŸåŒ– (launchAppã‹ã‚‰å‘¼ã°ã‚Œã‚‹)
        function initAppForGrade(grade) {
            // ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
            const titleEl = document.querySelector('#title-screen-app .game-title');
            titleEl.innerHTML = `${grade}ã­ã‚“ã›ã„<br>ã‹ã‚“ã˜<br>ãƒã‚¹ã‚¿ãƒ¼ v2`;

            // ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸èª­ã¿è¾¼ã¿ (å­¦å¹´ã”ã¨ã«ã‚­ãƒ¼ã‚’å¤‰ãˆã‚‹)
            progressPractice = JSON.parse(localStorage.getItem(`kanjiMasterPractice_${grade}`)) || {};
            progressTest = JSON.parse(localStorage.getItem(`kanjiMasterTest_${grade}`)) || {};

            // ç”»é¢ãƒªã‚»ãƒƒãƒˆ
            showAppScreen('title-screen-app');
        }

        // ç”»é¢é·ç§» (Appå†…)
        function showAppScreen(screenId) {
            document.querySelectorAll('#app-view .screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            if (screenId === 'list-screen') {
                document.getElementById('app-search-box').value = '';
                renderAppList(currentAppKanjiData);
            }
        }

        // ãƒ¢ãƒ¼ãƒ‰é¸æŠ
        function selectMode(mode) {
            playSound('click');
            currentMode = mode;
            showAppScreen('list-screen');
        }

        // æ¤œç´¢ (Appå†…)
        function filterAppList() {
            const searchText = document.getElementById('app-search-box').value.trim();
            if (searchText === '') {
                renderAppList(currentAppKanjiData);
                return;
            }
            const filtered = currentAppKanjiData.filter(item => {
                return item.char.includes(searchText) || item.reading.includes(searchText);
            });
            renderAppList(filtered);
        }

        // ãƒªã‚¹ãƒˆæç”» (App)
        function renderAppList(listData) {
            const grid = document.getElementById('kanji-grid');
            grid.innerHTML = '';
            
            const badge = document.getElementById('mode-display');
            const counter = document.getElementById('star-counter');
            const maxCount = document.getElementById('max-count');
            
            let totalCleared = 0;
            const targetProgress = (currentMode === 'practice') ? progressPractice : progressTest;
            
            // å…¨æ¼¢å­—æ•°ã§ã¯ãªãã€ç¾åœ¨ã®å­¦å¹´ã®æ¼¢å­—æ•°
            currentAppKanjiData.forEach(k => { if (targetProgress[k.char]) totalCleared++; });
            maxCount.innerText = currentAppKanjiData.length;

            if (currentMode === 'practice') {
                badge.textContent = "â­ ã‚Œã‚“ã—ã‚…ã†ãƒ¢ãƒ¼ãƒ‰";
                badge.style.backgroundColor = "#4CAF50";
            } else {
                badge.textContent = "ğŸ‘‘ ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰";
                badge.style.backgroundColor = "#F44336";
            }
            counter.innerText = totalCleared;

            if (listData.length === 0) {
                grid.innerHTML = '<div style="grid-column: 1/-1; text-align:center; color:#888;">ã¿ã¤ã‹ã‚Šã¾ã›ã‚“...</div>';
                return;
            }

            listData.forEach(item => {
                const isCleared = targetProgress[item.char];
                const card = document.createElement('div');
                card.className = `kanji-card`;
                if (isCleared) card.classList.add(currentMode === 'practice' ? 'cleared-practice' : 'cleared-test');
                
                card.innerHTML = `
                    ${item.char}
                    <div class="mark star-mark">â­</div>
                    <div class="mark crown-mark">ğŸ‘‘</div>
                `;
                card.onclick = () => {
                    playSound('click');
                    startWritingApp(item);
                };
                grid.appendChild(card);
            });
        }

        // æ›¸ãå–ã‚Šé–‹å§‹ (App)
        function startWritingApp(item) {
            currentChar = item;
            showAppScreen('practice-screen');
            document.getElementById('result-overlay').classList.remove('active');

            const screen = document.getElementById('practice-screen');
            const msgArea = document.getElementById('message-area');
            const readingDisplay = document.getElementById('current-reading');
            
            if (currentMode === 'test') {
                screen.classList.add('test-bg');
                msgArea.innerText = "ã“ã® ã‹ã‚“ã˜ ã‚’ ã‹ã“ã†ï¼";
                msgArea.style.color = "#C62828";
                readingDisplay.innerText = item.reading;
            } else {
                screen.classList.remove('test-bg');
                msgArea.innerText = "ã†ã™ã„ã›ã‚“ã‚’ ãªãã‚ã†ï¼";
                msgArea.style.color = "#006064";
                readingDisplay.innerText = `${item.char} (${item.reading})`;
            }

            document.getElementById('character-target-div').innerHTML = '';
            document.getElementById('anim-star').style.display = 'none';
            document.getElementById('anim-crown').style.display = 'none';

            const isTest = (currentMode === 'test');

            writer = HanziWriter.create('character-target-div', item.char, {
                width: 300, height: 300, padding: 10,
                showOutline: !isTest, strokeAnimationSpeed: 1, delayBetweenStrokes: 200,
                radicalColor: '#168F16', drawingWidth: 25, outlineColor: '#DDD',
                strokeColor: '#333', highlightColor: '#FF7043', showHintAfterMisses: 1,
                
                charDataLoader: (char, onComplete) => {
                    fetch(`https://cdn.jsdelivr.net/gh/chanind/hanzi-writer-data-jp@master/data/${char}.json`)
                        .then(res => {
                            if (!res.ok) throw new Error('JP Data not found');
                            return res.json();
                        })
                        .then(data => onComplete(data))
                        .catch(err => {
                            console.log("Fallback to default");
                            fetch(`https://cdn.jsdelivr.net/npm/hanzi-writer-data@2.0/${char}.json`)
                                .then(res => res.json())
                                .then(data => onComplete(data));
                        });
                }
            });
            startQuiz();
        }

        function startQuiz() {
            writer.quiz({
                onMistake: function() {
                    playSound('error');
                    const msg = document.getElementById('message-area');
                    msg.innerText = (currentMode === 'test') ? "ãŠã—ã„ï¼ ãƒ’ãƒ³ãƒˆã‚’ã¿ã¦ã­" : "ã“ã“ã ã‚ˆï¼";
                    msg.style.color = "#D32F2F";
                },
                onCorrectStroke: function() {
                    playSound('success');
                    const msg = document.getElementById('message-area');
                    msg.innerText = "ã„ã„ã­ï¼";
                    msg.style.color = "#388E3C";
                },
                onComplete: function() {
                    handleComplete();
                }
            });
        }

        function handleComplete() {
            const msg = document.getElementById('message-area');
            const resultTitle = document.getElementById('result-title-text');
            
            // â˜… XPã®åŠ ç®—å‡¦ç† (ãƒãƒ¼ã‚¿ãƒ«å´ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™) â˜…
            // ãƒãƒ¼ã‚¿ãƒ«å´ã® updateXP() ã‚’å‘¼ã³å‡ºã—ã¦ã€ãƒãƒ¼ã‚¿ãƒ«ã®ãƒ¬ãƒ™ãƒ«ã«åæ˜ ã•ã›ã‚‹
            updateXP(); 

            if (currentMode === 'practice') {
                playSound('levelup');
                msg.innerText = "ã§ããŸãƒ¼ï¼ â­ã‚²ãƒƒãƒˆï¼";
                resultTitle.innerText = "ã§ããŸãƒ¼ï¼â­";
                resultTitle.style.color = "#4CAF50";
                document.getElementById('anim-star').style.display = 'block';
                
                progressPractice[currentChar.char] = true;
                localStorage.setItem(`kanjiMasterPractice_${currentGrade}`, JSON.stringify(progressPractice));
            } else {
                playSound('levelup');
                msg.innerText = "ã™ã”ã„ï¼ï¼ ğŸ‘‘ã‚²ãƒƒãƒˆï¼";
                resultTitle.innerText = "ã™ã”ã„ï¼ğŸ‘‘";
                resultTitle.style.color = "#F44336";
                document.getElementById('anim-crown').style.display = 'block';
                
                progressTest[currentChar.char] = true;
                localStorage.setItem(`kanjiMasterTest_${currentGrade}`, JSON.stringify(progressTest));
            }
            setTimeout(() => {
                playSound('complete');
                document.getElementById('result-overlay').classList.add('active');
            }, 1000);
        }

        function goNext() {
            const currentIndex = currentAppKanjiData.findIndex(k => k.char === currentChar.char);
            if (currentIndex >= 0 && currentIndex < currentAppKanjiData.length - 1) {
                startWritingApp(currentAppKanjiData[currentIndex + 1]);
            } else {
                alert("ã“ã‚Œã§ãŠã—ã¾ã„ï¼ ã™ã”ã„ï¼");
                showAppScreen('list-screen');
            }
        }
        function retry() { startWritingApp(currentChar); }
        
        function resetAppData() {
            if(confirm('ã»ã‚“ã¨ã†ã« ã“ã®å­¦å¹´ã®ãƒ‡ãƒ¼ã‚¿ã‚’ ã‘ã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem(`kanjiMasterPractice_${currentGrade}`);
                localStorage.removeItem(`kanjiMasterTest_${currentGrade}`);
                progressPractice = {};
                progressTest = {};
                renderAppList(currentAppKanjiData);
            }
        }
    </script>
 </body>
</html>

